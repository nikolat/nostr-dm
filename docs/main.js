/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={9822:(t,e)=>{"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("hash must be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=o,e.hash=i,e.exists=s,e.output=a;const c={number:n,bool:r,bytes:o,hash:i,exists:s,output:a};e.default=c},4876:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.poly1305=e.wrapConstructorWithKey=void 0;const r=n(8225),o=n(9822),i=(t,e)=>255&t[e++]|(255&t[e++])<<8;class s{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=(0,r.toBytes)(t),(0,r.ensureBytes)(t,32);const e=i(t,0),n=i(t,2),o=i(t,4),s=i(t,6),a=i(t,8),c=i(t,10),u=i(t,12),l=i(t,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|n<<3),this.r[2]=7939&(n>>>10|o<<6),this.r[3]=8191&(o>>>7|s<<9),this.r[4]=255&(s>>>4|a<<12),this.r[5]=a>>>1&8190,this.r[6]=8191&(a>>>14|c<<2),this.r[7]=8065&(c>>>11|u<<5),this.r[8]=8191&(u>>>8|l<<8),this.r[9]=l>>>5&127;for(let e=0;e<8;e++)this.pad[e]=i(t,16+2*e)}process(t,e,n=!1){const r=n?0:2048,{h:o,r:s}=this,a=s[0],c=s[1],u=s[2],l=s[3],f=s[4],h=s[5],d=s[6],p=s[7],y=s[8],b=s[9],g=i(t,e+0),_=i(t,e+2),w=i(t,e+4),v=i(t,e+6),m=i(t,e+8),E=i(t,e+10),x=i(t,e+12),O=i(t,e+14);let B=o[0]+(8191&g),S=o[1]+(8191&(g>>>13|_<<3)),A=o[2]+(8191&(_>>>10|w<<6)),k=o[3]+(8191&(w>>>7|v<<9)),T=o[4]+(8191&(v>>>4|m<<12)),I=o[5]+(m>>>1&8191),L=o[6]+(8191&(m>>>14|E<<2)),C=o[7]+(8191&(E>>>11|x<<5)),P=o[8]+(8191&(x>>>8|O<<8)),j=o[9]+(O>>>5|r),U=0,H=U+B*a+S*(5*b)+A*(5*y)+k*(5*p)+T*(5*d);U=H>>>13,H&=8191,H+=I*(5*h)+L*(5*f)+C*(5*l)+P*(5*u)+j*(5*c),U+=H>>>13,H&=8191;let R=U+B*c+S*a+A*(5*b)+k*(5*y)+T*(5*p);U=R>>>13,R&=8191,R+=I*(5*d)+L*(5*h)+C*(5*f)+P*(5*l)+j*(5*u),U+=R>>>13,R&=8191;let q=U+B*u+S*c+A*a+k*(5*b)+T*(5*y);U=q>>>13,q&=8191,q+=I*(5*p)+L*(5*d)+C*(5*h)+P*(5*f)+j*(5*l),U+=q>>>13,q&=8191;let N=U+B*l+S*u+A*c+k*a+T*(5*b);U=N>>>13,N&=8191,N+=I*(5*y)+L*(5*p)+C*(5*d)+P*(5*h)+j*(5*f),U+=N>>>13,N&=8191;let M=U+B*f+S*l+A*u+k*c+T*a;U=M>>>13,M&=8191,M+=I*(5*b)+L*(5*y)+C*(5*p)+P*(5*d)+j*(5*h),U+=M>>>13,M&=8191;let $=U+B*h+S*f+A*l+k*u+T*c;U=$>>>13,$&=8191,$+=I*a+L*(5*b)+C*(5*y)+P*(5*p)+j*(5*d),U+=$>>>13,$&=8191;let D=U+B*d+S*h+A*f+k*l+T*u;U=D>>>13,D&=8191,D+=I*c+L*a+C*(5*b)+P*(5*y)+j*(5*p),U+=D>>>13,D&=8191;let F=U+B*p+S*d+A*h+k*f+T*l;U=F>>>13,F&=8191,F+=I*u+L*c+C*a+P*(5*b)+j*(5*y),U+=F>>>13,F&=8191;let z=U+B*y+S*p+A*d+k*h+T*f;U=z>>>13,z&=8191,z+=I*l+L*u+C*c+P*a+j*(5*b),U+=z>>>13,z&=8191;let V=U+B*b+S*y+A*p+k*d+T*h;U=V>>>13,V&=8191,V+=I*f+L*l+C*u+P*c+j*a,U+=V>>>13,V&=8191,U=(U<<2)+U|0,U=U+H|0,H=8191&U,U>>>=13,R+=U,o[0]=H,o[1]=R,o[2]=q,o[3]=N,o[4]=M,o[5]=$,o[6]=D,o[7]=F,o[8]=z,o[9]=V}finalize(){const{h:t,pad:e}=this,n=new Uint16Array(10);let r=t[1]>>>13;t[1]&=8191;for(let e=2;e<10;e++)t[e]+=r,r=t[e]>>>13,t[e]&=8191;t[0]+=5*r,r=t[0]>>>13,t[0]&=8191,t[1]+=r,r=t[1]>>>13,t[1]&=8191,t[2]+=r,n[0]=t[0]+5,r=n[0]>>>13,n[0]&=8191;for(let e=1;e<10;e++)n[e]=t[e]+r,r=n[e]>>>13,n[e]&=8191;n[9]-=8192;let o=(1^r)-1;for(let t=0;t<10;t++)n[t]&=o;o=~o;for(let e=0;e<10;e++)t[e]=t[e]&o|n[e];t[0]=65535&(t[0]|t[1]<<13),t[1]=65535&(t[1]>>>3|t[2]<<10),t[2]=65535&(t[2]>>>6|t[3]<<7),t[3]=65535&(t[3]>>>9|t[4]<<4),t[4]=65535&(t[4]>>>12|t[5]<<1|t[6]<<14),t[5]=65535&(t[6]>>>2|t[7]<<11),t[6]=65535&(t[7]>>>5|t[8]<<8),t[7]=65535&(t[8]>>>8|t[9]<<5);let i=t[0]+e[0];t[0]=65535&i;for(let n=1;n<8;n++)i=(t[n]+e[n]|0)+(i>>>16)|0,t[n]=65535&i}update(t){o.default.exists(this);const{buffer:e,blockLen:n}=this,i=(t=(0,r.toBytes)(t)).length;for(let r=0;r<i;){const o=Math.min(n-this.pos,i-r);if(o!==n)e.set(t.subarray(r,r+o),this.pos),this.pos+=o,r+=o,this.pos===n&&(this.process(e,0,!1),this.pos=0);else for(;n<=i-r;r+=n)this.process(t,r)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){o.default.exists(this),o.default.output(t,this),this.finished=!0;const{buffer:e,h:n}=this;let{pos:r}=this;if(r){for(e[r++]=1;r<16;r++)e[r]=0;this.process(e,0,!0)}this.finalize();let i=0;for(let e=0;e<8;e++)t[i++]=n[e]>>>0,t[i++]=n[e]>>>8;return t}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}}function a(t){const e=(e,n)=>t(n).update((0,r.toBytes)(e)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e}e.wrapConstructorWithKey=a,e.poly1305=a((t=>new s(t)))},4701:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.salsaBasic=void 0;const r=n(9822),o=n(8225),i=(0,o.utf8ToBytes)("expand 16-byte k"),s=(0,o.utf8ToBytes)("expand 32-byte k"),a=(0,o.u32)(i),c=(0,o.u32)(s),u=t=>!(t.byteOffset%4);e.salsaBasic=t=>{const{core:e,rounds:n,counterRight:i,counterLen:s,allow128bitKeys:l,extendNonceFn:f,blockLen:h}=(0,o.checkOpts)({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);r.default.number(s),r.default.number(n),r.default.number(h),r.default.bool(i),r.default.bool(l);const d=h/4;if(h%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(t,p,y,b,g=0)=>{if(r.default.bytes(t),r.default.bytes(p),r.default.bytes(y),b||(b=new Uint8Array(y.length)),r.default.bytes(b),r.default.number(g),g<0||g>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(b.length<y.length)throw new Error(`Salsa/ChaCha: output (${b.length}) is shorter than data (${y.length})`);const _=[];let w,v;if(32===t.length)w=t,v=c;else{if(16!==t.length||!l)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${t.length}`);w=new Uint8Array(32),w.set(t),w.set(t,16),v=a,_.push(w)}if(f){if(p.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");w=f(v,w,p.subarray(0,16),new Uint8Array(32)),_.push(w),p=p.subarray(16)}const m=16-s;if(p.length!==m)throw new Error(`Salsa/ChaCha: nonce must be ${m} or 16 bytes`);if(12!==m){const t=new Uint8Array(12);t.set(p,i?0:12-p.length),_.push(p=t)}const E=new Uint8Array(h),x=(0,o.u32)(E),O=(0,o.u32)(w),B=(0,o.u32)(p),S=u(y)&&(0,o.u32)(y),A=u(b)&&(0,o.u32)(b);_.push(x);const k=y.length;for(let t=0,r=g;t<k;r++){if(e(v,O,B,x,r,n),r>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const o=Math.min(h,k-t);if(o===h&&A&&S){const e=t/4;if(t%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let t=0;t<d;t++)A[e+t]=S[e+t]^x[t];t+=h}else{for(let e=0;e<o;e++)b[t+e]=y[t+e]^E[e];t+=o}}for(let t=0;t<_.length;t++)_[t].fill(0);return b}}},7218:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.xchacha20poly1305=e.chacha20poly1305=e._poly1305_aead=e.chacha12=e.chacha8=e.xchacha20=e.chacha20=e.chacha20orig=e.hchacha=void 0;const r=n(8225),o=n(4876),i=n(4701),s=(t,e)=>t<<e|t>>>32-e;function a(t,e,n,r,o,i=20){let a=t[0],c=t[1],u=t[2],l=t[3],f=e[0],h=e[1],d=e[2],p=e[3],y=e[4],b=e[5],g=e[6],_=e[7],w=o,v=n[0],m=n[1],E=n[2],x=a,O=c,B=u,S=l,A=f,k=h,T=d,I=p,L=y,C=b,P=g,j=_,U=w,H=v,R=m,q=E;for(let t=0;t<i;t+=2)x=x+A|0,U=s(U^x,16),L=L+U|0,A=s(A^L,12),x=x+A|0,U=s(U^x,8),L=L+U|0,A=s(A^L,7),O=O+k|0,H=s(H^O,16),C=C+H|0,k=s(k^C,12),O=O+k|0,H=s(H^O,8),C=C+H|0,k=s(k^C,7),B=B+T|0,R=s(R^B,16),P=P+R|0,T=s(T^P,12),B=B+T|0,R=s(R^B,8),P=P+R|0,T=s(T^P,7),S=S+I|0,q=s(q^S,16),j=j+q|0,I=s(I^j,12),S=S+I|0,q=s(q^S,8),j=j+q|0,I=s(I^j,7),x=x+k|0,q=s(q^x,16),P=P+q|0,k=s(k^P,12),x=x+k|0,q=s(q^x,8),P=P+q|0,k=s(k^P,7),O=O+T|0,U=s(U^O,16),j=j+U|0,T=s(T^j,12),O=O+T|0,U=s(U^O,8),j=j+U|0,T=s(T^j,7),B=B+I|0,H=s(H^B,16),L=L+H|0,I=s(I^L,12),B=B+I|0,H=s(H^B,8),L=L+H|0,I=s(I^L,7),S=S+A|0,R=s(R^S,16),C=C+R|0,A=s(A^C,12),S=S+A|0,R=s(R^S,8),C=C+R|0,A=s(A^C,7);let N=0;r[N++]=a+x|0,r[N++]=c+O|0,r[N++]=u+B|0,r[N++]=l+S|0,r[N++]=f+A|0,r[N++]=h+k|0,r[N++]=d+T|0,r[N++]=p+I|0,r[N++]=y+L|0,r[N++]=b+C|0,r[N++]=g+P|0,r[N++]=_+j|0,r[N++]=w+U|0,r[N++]=v+H|0,r[N++]=m+R|0,r[N++]=E+q|0}function c(t,e,n,o){const i=(0,r.u32)(e),a=(0,r.u32)(n),c=(0,r.u32)(o);let u=t[0],l=t[1],f=t[2],h=t[3],d=i[0],p=i[1],y=i[2],b=i[3],g=i[4],_=i[5],w=i[6],v=i[7],m=a[0],E=a[1],x=a[2],O=a[3];for(let t=0;t<20;t+=2)u=u+d|0,m=s(m^u,16),g=g+m|0,d=s(d^g,12),u=u+d|0,m=s(m^u,8),g=g+m|0,d=s(d^g,7),l=l+p|0,E=s(E^l,16),_=_+E|0,p=s(p^_,12),l=l+p|0,E=s(E^l,8),_=_+E|0,p=s(p^_,7),f=f+y|0,x=s(x^f,16),w=w+x|0,y=s(y^w,12),f=f+y|0,x=s(x^f,8),w=w+x|0,y=s(y^w,7),h=h+b|0,O=s(O^h,16),v=v+O|0,b=s(b^v,12),h=h+b|0,O=s(O^h,8),v=v+O|0,b=s(b^v,7),u=u+p|0,O=s(O^u,16),w=w+O|0,p=s(p^w,12),u=u+p|0,O=s(O^u,8),w=w+O|0,p=s(p^w,7),l=l+y|0,m=s(m^l,16),v=v+m|0,y=s(y^v,12),l=l+y|0,m=s(m^l,8),v=v+m|0,y=s(y^v,7),f=f+b|0,E=s(E^f,16),g=g+E|0,b=s(b^g,12),f=f+b|0,E=s(E^f,8),g=g+E|0,b=s(b^g,7),h=h+d|0,x=s(x^h,16),_=_+x|0,d=s(d^_,12),h=h+d|0,x=s(x^h,8),_=_+x|0,d=s(d^_,7);return c[0]=u,c[1]=l,c[2]=f,c[3]=h,c[4]=m,c[5]=E,c[6]=x,c[7]=O,o}e.hchacha=c,e.chacha20orig=(0,i.salsaBasic)({core:a,counterRight:!1,counterLen:8}),e.chacha20=(0,i.salsaBasic)({core:a,counterRight:!1,counterLen:4,allow128bitKeys:!1}),e.xchacha20=(0,i.salsaBasic)({core:a,counterRight:!1,counterLen:8,extendNonceFn:c,allow128bitKeys:!1}),e.chacha8=(0,i.salsaBasic)({core:a,counterRight:!1,counterLen:4,rounds:8}),e.chacha12=(0,i.salsaBasic)({core:a,counterRight:!1,counterLen:4,rounds:12});const u=new Uint8Array(16),l=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(u.subarray(n))},f=(t,e,n,i,s)=>{const a=t(e,n,new Uint8Array(32)),c=o.poly1305.create(a);s&&l(c,s),l(c,i);const u=new Uint8Array(16),f=(0,r.createView)(u);(0,r.setBigUint64)(f,0,BigInt(s?s.length:0),!0),(0,r.setBigUint64)(f,8,BigInt(i.length),!0),c.update(u);const h=c.digest();return a.fill(0),h};e._poly1305_aead=t=>(e,n,o)=>((0,r.ensureBytes)(e,32),(0,r.ensureBytes)(n),{tagLength:16,encrypt:(i,s)=>{const a=i.length,c=a+16;s?(0,r.ensureBytes)(s,c):s=new Uint8Array(c),t(e,n,i,s,1);const u=f(t,e,n,s.subarray(0,-16),o);return s.set(u,a),s},decrypt:(i,s)=>{const a=i.length,c=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");s?(0,r.ensureBytes)(s,c):s=new Uint8Array(c);const u=i.subarray(0,-16),l=i.subarray(-16),h=f(t,e,n,u,o);if(!(0,r.equalBytes)(l,h))throw new Error("invalid tag");return t(e,n,u,s,1),s}}),e.chacha20poly1305=(0,e._poly1305_aead)(e.chacha20),e.xchacha20poly1305=(0,e._poly1305_aead)(e.xchacha20)},8225:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setBigUint64=e.Hash=e.equalBytes=e.ensureBytes=e.checkOpts=e.concatBytes=e.toBytes=e.bytesToUtf8=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.createView=e.u32=e.u16=e.u8=void 0;const n=t=>t instanceof Uint8Array;if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u16=t=>new Uint16Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/2)),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function o(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}e.bytesToHex=function(t){if(!n(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=r[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let i=0;i<t;i++){r(i);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=o,e.bytesToUtf8=function(t){return(new TextDecoder).decode(t)},e.toBytes=function(t){if("string"==typeof t&&(t=o(t)),!n(t))throw new Error("expected Uint8Array, got "+typeof t);return t},e.concatBytes=function(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let r=0;return t.forEach((t=>{if(!n(t))throw new Error("Uint8Array expected");e.set(t,r),r+=t.length})),e},e.checkOpts=function(t,e){if(void 0!==e&&("object"!=typeof e||(n=e,"[object Object]"!==Object.prototype.toString.call(n)||n.constructor!==Object)))throw new Error("options must be object or undefined");var n;return Object.assign(t,e)},e.ensureBytes=function(t,e){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof e&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)},e.equalBytes=function(t,e){if(t.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let n=!0;for(let r=0;r<t.length;r++)n&&(n=t[r]===e[r]);return n},e.Hash=class{},e.setBigUint64=function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}},9082:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCurve=e.getHash=void 0;const r=n(1128),o=n(1717),i=n(6551);function s(t){return{hash:t,hmac:(e,...n)=>(0,r.hmac)(t,e,(0,o.concatBytes)(...n)),randomBytes:o.randomBytes}}e.getHash=s,e.createCurve=function(t,e){const n=e=>(0,i.weierstrass)({...t,...s(e)});return Object.freeze({...n(e),create:n})}},1525:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateBasic=e.wNAF=void 0;const r=n(4632),o=n(219),i=BigInt(0),s=BigInt(1);e.wNAF=function(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,o=e;for(;n>i;)n&s&&(r=r.add(o)),o=o.double(),n>>=s;return r},precomputeWindow(t,e){const{windows:n,windowSize:o}=r(e),i=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,i.push(a);for(let t=1;t<o;t++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(e,o,i){const{windows:a,windowSize:c}=r(e);let u=t.ZERO,l=t.BASE;const f=BigInt(2**e-1),h=2**e,d=BigInt(e);for(let t=0;t<a;t++){const e=t*c;let r=Number(i&f);i>>=d,r>c&&(r-=h,i+=s);const a=e,p=e+Math.abs(r)-1,y=t%2!=0,b=r<0;0===r?l=l.add(n(y,o[a])):u=u.add(n(b,o[p]))}return{p:u,f:l}},wNAFCached(t,e,n,r){const o=t._WINDOW_SIZE||1;let i=e.get(t);return i||(i=this.precomputeWindow(t,o),1!==o&&e.set(t,r(i))),this.wNAF(o,i,n)}}},e.validateBasic=function(t){return(0,r.validateField)(t.Fp),(0,o.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,r.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}},5134:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createHasher=e.isogenyMap=e.hash_to_field=e.expand_message_xof=e.expand_message_xmd=void 0;const r=n(4632),o=n(219),i=o.bytesToNumberBE;function s(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=255&t,t>>>=8;return new Uint8Array(n)}function a(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function c(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function u(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function l(t,e,n,r){c(t),c(e),u(n),e.length>255&&(e=r((0,o.concatBytes)((0,o.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:l}=r,f=Math.ceil(n/i);if(f>255)throw new Error("Invalid xmd length");const h=(0,o.concatBytes)(e,s(e.length,1)),d=s(0,l),p=s(n,2),y=new Array(f),b=r((0,o.concatBytes)(d,t,p,s(0,1),h));y[0]=r((0,o.concatBytes)(b,s(1,1),h));for(let t=1;t<=f;t++){const e=[a(b,y[t-1]),s(t+1,1),h];y[t]=r((0,o.concatBytes)(...e))}return(0,o.concatBytes)(...y).slice(0,n)}function f(t,e,n,r,i){if(c(t),c(e),u(n),e.length>255){const t=Math.ceil(2*r/8);e=i.create({dkLen:t}).update((0,o.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update(s(n,2)).update(e).update(s(e.length,1)).digest()}function h(t,e,n){(0,o.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:s,k:a,m:h,hash:d,expand:p,DST:y}=n;c(t),u(e);const b=function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return(0,o.utf8ToBytes)(t);throw new Error("DST must be Uint8Array or string")}(y),g=s.toString(2).length,_=Math.ceil((g+a)/8),w=e*h*_;let v;if("xmd"===p)v=l(t,b,w,d);else if("xof"===p)v=f(t,b,w,a,d);else{if("_internal_pass"!==p)throw new Error('expand must be "xmd" or "xof"');v=t}const m=new Array(e);for(let t=0;t<e;t++){const e=new Array(h);for(let n=0;n<h;n++){const o=_*(n+t*h),a=v.subarray(o,o+_);e[n]=(0,r.mod)(i(a),s)}m[t]=e}return m}e.expand_message_xmd=l,e.expand_message_xof=f,e.hash_to_field=h,e.isogenyMap=function(t,e){const n=e.map((t=>Array.from(t).reverse()));return(e,r)=>{const[o,i,s,a]=n.map((n=>n.reduce(((n,r)=>t.add(t.mul(n,e),r)))));return e=t.div(o,i),r=t.mul(r,t.div(s,a)),{x:e,y:r}}},e.createHasher=function(t,e,n){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");return{hashToCurve(r,o){const i=h(r,2,{...n,DST:n.DST,...o}),s=t.fromAffine(e(i[0])),a=t.fromAffine(e(i[1])),c=s.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(r,o){const i=h(r,1,{...n,DST:n.encodeDST,...o}),s=t.fromAffine(e(i[0])).clearCofactor();return s.assertValidity(),s}}}},4632:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapHashToField=e.getMinHashLength=e.getFieldBytesLength=e.hashToPrivateScalar=e.FpSqrtEven=e.FpSqrtOdd=e.Field=e.nLength=e.FpIsSquare=e.FpDiv=e.FpInvertBatch=e.FpPow=e.validateField=e.isNegativeLE=e.FpSqrt=e.tonelliShanks=e.invert=e.pow2=e.pow=e.mod=void 0;const r=n(219),o=BigInt(0),i=BigInt(1),s=BigInt(2),a=BigInt(3),c=BigInt(4),u=BigInt(5),l=BigInt(8);function f(t,e){const n=t%e;return n>=o?n:e+n}function h(t,e,n){if(n<=o||e<o)throw new Error("Expected power/modulo > 0");if(n===i)return o;let r=i;for(;e>o;)e&i&&(r=r*t%n),t=t*t%n,e>>=i;return r}function d(t,e){if(t===o||e<=o)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=f(t,e),r=e,s=o,a=i,c=i,u=o;for(;n!==o;){const t=r/n,e=r%n,o=s-c*t,i=a-u*t;r=n,n=e,s=c,a=u,c=o,u=i}if(r!==i)throw new Error("invert: does not exist");return f(s,e)}function p(t){const e=(t-i)/s;let n,r,a;for(n=t-i,r=0;n%s===o;n/=s,r++);for(a=s;a<t&&h(a,e,t)!==t-i;a++);if(1===r){const e=(t+i)/c;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const u=(n+i)/s;return function(t,o){if(t.pow(o,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let s=r,c=t.pow(t.mul(t.ONE,a),n),l=t.pow(o,u),f=t.pow(o,n);for(;!t.eql(f,t.ONE);){if(t.eql(f,t.ZERO))return t.ZERO;let e=1;for(let n=t.sqr(f);e<s&&!t.eql(n,t.ONE);e++)n=t.sqr(n);const n=t.pow(c,i<<BigInt(s-e-1));c=t.sqr(n),l=t.mul(l,n),f=t.mul(f,c),s=e}return l}}function y(t){if(t%c===a){const e=(t+i)/c;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%l===u){const e=(t-u)/l;return function(t,n){const r=t.mul(n,s),o=t.pow(r,e),i=t.mul(n,o),a=t.mul(t.mul(i,s),o),c=t.mul(i,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return p(t)}BigInt(9),BigInt(16),e.mod=f,e.pow=h,e.pow2=function(t,e,n){let r=t;for(;e-- >o;)r*=r,r%=n;return r},e.invert=d,e.tonelliShanks=p,e.FpSqrt=y,e.isNegativeLE=(t,e)=>(f(t,e)&i)===i;const b=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function g(t,e,n){if(n<o)throw new Error("Expected power > 0");if(n===o)return t.ONE;if(n===i)return e;let r=t.ONE,s=e;for(;n>o;)n&i&&(r=t.mul(r,s)),s=t.sqr(s),n>>=i;return r}function _(t,e){const n=new Array(e.length),r=e.reduce(((e,r,o)=>t.is0(r)?e:(n[o]=e,t.mul(e,r))),t.ONE),o=t.inv(r);return e.reduceRight(((e,r,o)=>t.is0(r)?e:(n[o]=t.mul(e,n[o]),t.mul(e,r))),o),n}function w(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function v(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function m(t){const e=v(t);return e+Math.ceil(e/2)}e.validateField=function(t){const e=b.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,r.validateObject)(t,e)},e.FpPow=g,e.FpInvertBatch=_,e.FpDiv=function(t,e,n){return t.mul(e,"bigint"==typeof n?d(n,t.ORDER):t.inv(n))},e.FpIsSquare=function(t){const e=(t.ORDER-i)/s;return n=>{const r=t.pow(n,e);return t.eql(r,t.ZERO)||t.eql(r,t.ONE)}},e.nLength=w,e.Field=function(t,e,n=!1,s={}){if(t<=o)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:a,nByteLength:c}=w(t,e);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");const u=y(t),l=Object.freeze({ORDER:t,BITS:a,BYTES:c,MASK:(0,r.bitMask)(a),ZERO:o,ONE:i,create:e=>f(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return o<=e&&e<t},is0:t=>t===o,isOdd:t=>(t&i)===i,neg:e=>f(-e,t),eql:(t,e)=>t===e,sqr:e=>f(e*e,t),add:(e,n)=>f(e+n,t),sub:(e,n)=>f(e-n,t),mul:(e,n)=>f(e*n,t),pow:(t,e)=>g(l,t,e),div:(e,n)=>f(e*d(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>d(e,t),sqrt:s.sqrt||(t=>u(l,t)),invertBatch:t=>_(l,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?(0,r.numberToBytesLE)(t,c):(0,r.numberToBytesBE)(t,c),fromBytes:t=>{if(t.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${t.length}`);return n?(0,r.bytesToNumberLE)(t):(0,r.bytesToNumberBE)(t)}});return Object.freeze(l)},e.FpSqrtOdd=function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?n:t.neg(n)},e.FpSqrtEven=function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?t.neg(n):n},e.hashToPrivateScalar=function(t,e,n=!1){const o=(t=(0,r.ensureBytes)("privateHash",t)).length,s=w(e).nByteLength+8;if(s<24||o<s||o>1024)throw new Error(`hashToPrivateScalar: expected ${s}-1024 bytes of input, got ${o}`);return f(n?(0,r.bytesToNumberLE)(t):(0,r.bytesToNumberBE)(t),e-i)+i},e.getFieldBytesLength=v,e.getMinHashLength=m,e.mapHashToField=function(t,e,n=!1){const o=t.length,s=v(e),a=m(e);if(o<16||o<a||o>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${o}`);const c=f(n?(0,r.bytesToNumberBE)(t):(0,r.bytesToNumberLE)(t),e-i)+i;return n?(0,r.numberToBytesLE)(c,s):(0,r.numberToBytesBE)(c,s)}},219:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateObject=e.createHmacDrbg=e.bitMask=e.bitSet=e.bitGet=e.bitLen=e.utf8ToBytes=e.equalBytes=e.concatBytes=e.ensureBytes=e.numberToVarBytesBE=e.numberToBytesLE=e.numberToBytesBE=e.bytesToNumberLE=e.bytesToNumberBE=e.hexToBytes=e.hexToNumber=e.numberToHexUnpadded=e.bytesToHex=void 0;const n=BigInt(0),r=BigInt(1),o=BigInt(2),i=t=>t instanceof Uint8Array,s=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function a(t){if(!i(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=s[t[n]];return e}function c(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function u(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function l(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n}function f(t,e){return l(t.toString(16).padStart(2*e,"0"))}function h(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let n=0;return t.forEach((t=>{if(!i(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length})),e}e.bytesToHex=a,e.numberToHexUnpadded=c,e.hexToNumber=u,e.hexToBytes=l,e.bytesToNumberBE=function(t){return u(a(t))},e.bytesToNumberLE=function(t){if(!i(t))throw new Error("Uint8Array expected");return u(a(Uint8Array.from(t).reverse()))},e.numberToBytesBE=f,e.numberToBytesLE=function(t,e){return f(t,e).reverse()},e.numberToVarBytesBE=function(t){return l(c(t))},e.ensureBytes=function(t,e,n){let r;if("string"==typeof e)try{r=l(e)}catch(n){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${n}`)}else{if(!i(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r},e.concatBytes=h,e.equalBytes=function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},e.utf8ToBytes=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},e.bitLen=function(t){let e;for(e=0;t>n;t>>=r,e+=1);return e},e.bitGet=function(t,e){return t>>BigInt(e)&r},e.bitSet=(t,e,o)=>t|(o?r:n)<<BigInt(e),e.bitMask=t=>(o<<BigInt(t-1))-r;const d=t=>new Uint8Array(t),p=t=>Uint8Array.from(t);e.createHmacDrbg=function(t,e,n){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=d(t),o=d(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...t)=>n(o,r,...t),c=(t=d())=>{o=a(p([0]),t),r=a(),0!==t.length&&(o=a(p([1]),t),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=a();const e=r.slice();n.push(e),t+=r.length}return h(...n)};return(t,e)=>{let n;for(s(),c(t);!(n=e(u()));)c();return s(),n}};const y={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};e.validateObject=function(t,e,n={}){const r=(e,n,r)=>{const o=y[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=t[e];if(!(r&&void 0===i||o(i,t)))throw new Error(`Invalid param ${String(e)}=${i} (${typeof i}), expected ${n}`)};for(const[t,n]of Object.entries(e))r(t,n,!1);for(const[t,e]of Object.entries(n))r(t,e,!0);return t}},6551:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapToCurveSimpleSWU=e.SWUFpSqrtRatio=e.weierstrass=e.weierstrassPoints=e.DER=void 0;const r=n(4632),o=n(219),i=n(219),s=n(1525),{bytesToNumberBE:a,hexToBytes:c}=o;e.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:n}=e.DER;if(t.length<2||2!==t[0])throw new n("Invalid signature integer tag");const r=t[1],o=t.subarray(2,r+2);if(!r||o.length!==r)throw new n("Invalid signature integer: wrong length");if(128&o[0])throw new n("Invalid signature integer: negative");if(0===o[0]&&!(128&o[1]))throw new n("Invalid signature integer: unnecessary leading zero");return{d:a(o),l:t.subarray(r+2)}},toSig(t){const{Err:n}=e.DER,r="string"==typeof t?c(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let o=r.length;if(o<2||48!=r[0])throw new n("Invalid signature tag");if(r[1]!==o-2)throw new n("Invalid signature: incorrect length");const{d:i,l:s}=e.DER._parseInt(r.subarray(2)),{d:a,l:u}=e.DER._parseInt(s);if(u.length)throw new n("Invalid signature: left bytes after parsing");return{r:i,s:a}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,n=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},r=e(n(t.s)),o=e(n(t.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}};const u=BigInt(0),l=BigInt(1),f=BigInt(2),h=BigInt(3),d=BigInt(4);function p(t){const e=function(t){const e=(0,s.validateBasic)(t);o.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=e;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,a=e.toBytes||((t,e,r)=>{const i=e.toAffine();return o.concatBytes(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),c=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function f(t){const{a:r,b:o}=e,i=n.sqr(t),s=n.mul(i,t);return n.add(n.add(s,n.mul(t,r)),o)}if(!n.eql(n.sqr(e.Gy),f(e.Gx)))throw new Error("bad generator point: equation left != right");function d(t){return"bigint"==typeof t&&u<t&&t<e.n}function p(t){if(!d(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function y(t){const{allowedPrivateKeyLengths:n,nByteLength:s,wrapPrivateKey:a,n:c}=e;if(n&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=o.bytesToHex(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*s,"0")}let u;try{u="bigint"==typeof t?t:o.bytesToNumberBE((0,i.ensureBytes)("private key",t,s))}catch(e){throw new Error(`private key must be ${s} bytes, hex or bigint, not ${typeof t}`)}return a&&(u=r.mod(u,c)),p(u),u}const b=new Map;function g(t){if(!(t instanceof _))throw new Error("ProjectivePoint expected")}class _{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof _)throw new Error("projective point not allowed");const o=t=>n.eql(t,n.ZERO);return o(e)&&o(r)?_.ZERO:new _(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map((t=>t.pz)));return t.map(((t,n)=>t.toAffine(e[n]))).map(_.fromAffine)}static fromHex(t){const e=_.fromAffine(c((0,i.ensureBytes)("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return _.BASE.multiply(y(t))}_setWindowSize(t){this._WINDOW_SIZE=t,b.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),i=f(t);if(!n.eql(o,i))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){g(t);const{px:e,py:r,pz:o}=this,{px:i,py:s,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new _(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,o=n.mul(r,h),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,f=n.mul(i,i),d=n.mul(s,s),p=n.mul(a,a),y=n.mul(i,s);return y=n.add(y,y),l=n.mul(i,a),l=n.add(l,l),c=n.mul(t,l),u=n.mul(o,p),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(y,c),l=n.mul(o,l),p=n.mul(t,p),y=n.sub(f,p),y=n.mul(t,y),y=n.add(y,l),l=n.add(f,f),f=n.add(l,f),f=n.add(f,p),f=n.mul(f,y),u=n.add(u,f),p=n.mul(s,a),p=n.add(p,p),f=n.mul(p,y),c=n.sub(c,f),l=n.mul(p,d),l=n.add(l,l),l=n.add(l,l),new _(c,u,l)}add(t){g(t);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=t;let u=n.ZERO,l=n.ZERO,f=n.ZERO;const d=e.a,p=n.mul(e.b,h);let y=n.mul(r,s),b=n.mul(o,a),w=n.mul(i,c),v=n.add(r,o),m=n.add(s,a);v=n.mul(v,m),m=n.add(y,b),v=n.sub(v,m),m=n.add(r,i);let E=n.add(s,c);return m=n.mul(m,E),E=n.add(y,w),m=n.sub(m,E),E=n.add(o,i),u=n.add(a,c),E=n.mul(E,u),u=n.add(b,w),E=n.sub(E,u),f=n.mul(d,m),u=n.mul(p,w),f=n.add(u,f),u=n.sub(b,f),f=n.add(b,f),l=n.mul(u,f),b=n.add(y,y),b=n.add(b,y),w=n.mul(d,w),m=n.mul(p,m),b=n.add(b,w),w=n.sub(y,w),w=n.mul(d,w),m=n.add(m,w),y=n.mul(b,m),l=n.add(l,y),y=n.mul(E,m),u=n.mul(v,u),u=n.sub(u,y),y=n.mul(v,b),f=n.mul(E,f),f=n.add(f,y),new _(u,l,f)}subtract(t){return this.add(t.negate())}is0(){return this.equals(_.ZERO)}wNAF(t){return v.wNAFCached(this,b,t,(t=>{const e=n.invertBatch(t.map((t=>t.pz)));return t.map(((t,n)=>t.toAffine(e[n]))).map(_.fromAffine)}))}multiplyUnsafe(t){const r=_.ZERO;if(t===u)return r;if(p(t),t===l)return this;const{endo:o}=e;if(!o)return v.unsafeLadder(this,t);let{k1neg:i,k1:s,k2neg:a,k2:c}=o.splitScalar(t),f=r,h=r,d=this;for(;s>u||c>u;)s&l&&(f=f.add(d)),c&l&&(h=h.add(d)),d=d.double(),s>>=l,c>>=l;return i&&(f=f.negate()),a&&(h=h.negate()),h=new _(n.mul(h.px,o.beta),h.py,h.pz),f.add(h)}multiply(t){p(t);let r,o,i=t;const{endo:s}=e;if(s){const{k1neg:t,k1:e,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(e),{p:f,f:h}=this.wNAF(c);u=v.constTimeNegate(t,u),f=v.constTimeNegate(a,f),f=new _(n.mul(f.px,s.beta),f.py,f.pz),r=u.add(f),o=l.add(h)}else{const{p:t,f:e}=this.wNAF(i);r=t,o=e}return _.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(t,e,n){const r=_.BASE,o=(t,e)=>e!==u&&e!==l&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),i=o(this,e).add(o(t,n));return i.is0()?void 0:i}toAffine(t){const{px:e,py:r,pz:o}=this,i=this.is0();null==t&&(t=i?n.ONE:n.inv(o));const s=n.mul(e,t),a=n.mul(r,t),c=n.mul(o,t);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===l)return!0;if(n)return n(_,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===l?this:n?n(_,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),a(_,this,t)}toHex(t=!0){return o.bytesToHex(this.toRawBytes(t))}}_.BASE=new _(e.Gx,e.Gy,n.ONE),_.ZERO=new _(n.ZERO,n.ONE,n.ZERO);const w=e.nBitLength,v=(0,s.wNAF)(_,e.endo?Math.ceil(w/2):w);return{CURVE:e,ProjectivePoint:_,normPrivateKeyToScalar:y,weierstrassEquation:f,isWithinCurveOrder:d}}function y(t,e){const n=t.ORDER;let r=u;for(let t=n-l;t%f===u;t/=f)r+=l;const o=r,i=f<<o-l-l,s=i*f,a=(n-l)/s,c=(a-l)/f,p=s-l,y=i,b=t.pow(e,a),g=t.pow(e,(a+l)/f);let _=(e,n)=>{let r=b,i=t.pow(n,p),s=t.sqr(i);s=t.mul(s,n);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,i),i=t.mul(a,n),s=t.mul(a,e);let u=t.mul(s,i);a=t.pow(u,y);let h=t.eql(a,t.ONE);i=t.mul(s,g),a=t.mul(u,r),s=t.cmov(i,s,h),u=t.cmov(a,u,h);for(let e=o;e>l;e--){let n=e-f;n=f<<n-l;let o=t.pow(u,n);const a=t.eql(o,t.ONE);i=t.mul(s,r),r=t.mul(r,r),o=t.mul(u,r),s=t.cmov(i,s,a),u=t.cmov(o,u,a)}return{isValid:h,value:s}};if(t.ORDER%d===h){const n=(t.ORDER-h)/d,r=t.sqrt(t.neg(e));_=(e,o)=>{let i=t.sqr(o);const s=t.mul(e,o);i=t.mul(i,s);let a=t.pow(i,n);a=t.mul(a,s);const c=t.mul(a,r),u=t.mul(t.sqr(a),o),l=t.eql(u,e);return{isValid:l,value:t.cmov(c,a,l)}}}return _}e.weierstrassPoints=p,e.weierstrass=function(t){const n=function(t){const e=(0,s.validateBasic)(t);return o.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:a,n:c}=n,f=a.BYTES+1,h=2*a.BYTES+1;function d(t){return r.mod(t,c)}function y(t){return r.invert(t,c)}const{ProjectivePoint:b,normPrivateKeyToScalar:g,weierstrassEquation:_,isWithinCurveOrder:w}=p({...n,toBytes(t,e,n){const r=e.toAffine(),i=a.toBytes(r.x),s=o.concatBytes;return n?s(Uint8Array.from([e.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,a.toBytes(r.y))},fromBytes(t){const e=t.length,n=t[0],r=t.subarray(1);if(e!==f||2!==n&&3!==n){if(e===h&&4===n)return{x:a.fromBytes(r.subarray(0,a.BYTES)),y:a.fromBytes(r.subarray(a.BYTES,2*a.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${f} compressed bytes or ${h} uncompressed bytes`)}{const t=o.bytesToNumberBE(r);if(!(u<(i=t)&&i<a.ORDER))throw new Error("Point is not on curve");const e=_(t);let s=a.sqrt(e);return 1==(1&n)!=((s&l)===l)&&(s=a.neg(s)),{x:t,y:s}}var i}}),v=t=>o.bytesToHex(o.numberToBytesBE(t,n.nByteLength));function m(t){return t>c>>l}const E=(t,e,n)=>o.bytesToNumberBE(t.slice(e,n));class x{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const e=n.nByteLength;return t=(0,i.ensureBytes)("compactSignature",t,2*e),new x(E(t,0,e),E(t,e,2*e))}static fromDER(t){const{r:n,s:r}=e.DER.toSig((0,i.ensureBytes)("DER",t));return new x(n,r)}assertValidity(){if(!w(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!w(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new x(this.r,this.s,t)}recoverPublicKey(t){const{r:e,s:r,recovery:o}=this,s=A((0,i.ensureBytes)("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const c=2===o||3===o?e+n.n:e;if(c>=a.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=0==(1&o)?"02":"03",l=b.fromHex(u+v(c)),f=y(c),h=d(-s*f),p=d(r*f),g=b.BASE.multiplyAndAddUnsafe(l,h,p);if(!g)throw new Error("point at infinify");return g.assertValidity(),g}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,d(-this.s),this.recovery):this}toDERRawBytes(){return o.hexToBytes(this.toDERHex())}toDERHex(){return e.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return o.hexToBytes(this.toCompactHex())}toCompactHex(){return v(this.r)+v(this.s)}}const O={isValidPrivateKey(t){try{return g(t),!0}catch(t){return!1}},normPrivateKeyToScalar:g,randomPrivateKey:()=>{const t=r.getMinHashLength(n.n);return r.mapHashToField(n.randomBytes(t),n.n)},precompute:(t=8,e=b.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function B(t){const e=t instanceof Uint8Array,n="string"==typeof t,r=(e||n)&&t.length;return e?r===f||r===h:n?r===2*f||r===2*h:t instanceof b}const S=n.bits2int||function(t){const e=o.bytesToNumberBE(t),r=8*t.length-n.nBitLength;return r>0?e>>BigInt(r):e},A=n.bits2int_modN||function(t){return d(S(t))},k=o.bitMask(n.nBitLength);function T(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(u<=t&&t<k))throw new Error(`bigint expected < 2^${n.nBitLength}`);return o.numberToBytesBE(t,n.nByteLength)}const I={lowS:n.lowS,prehash:!1},L={lowS:n.lowS,prehash:!1};return b.BASE._setWindowSize(8),{CURVE:n,getPublicKey:function(t,e=!0){return b.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,n=!0){if(B(t))throw new Error("first arg must be private key");if(!B(e))throw new Error("second arg must be public key");return b.fromHex(e).multiply(g(t)).toRawBytes(n)},sign:function(t,e,r=I){const{seed:s,k2sig:c}=function(t,e,r=I){if(["recovered","canonical"].some((t=>t in r)))throw new Error("sign() legacy options not supported");const{hash:s,randomBytes:c}=n;let{lowS:f,prehash:h,extraEntropy:p}=r;null==f&&(f=!0),t=(0,i.ensureBytes)("msgHash",t),h&&(t=(0,i.ensureBytes)("prehashed msgHash",s(t)));const _=A(t),v=g(e),E=[T(v),T(_)];if(null!=p){const t=!0===p?c(a.BYTES):p;E.push((0,i.ensureBytes)("extraEntropy",t))}const O=o.concatBytes(...E),B=_;return{seed:O,k2sig:function(t){const e=S(t);if(!w(e))return;const n=y(e),r=b.BASE.multiply(e).toAffine(),o=d(r.x);if(o===u)return;const i=d(n*d(B+o*v));if(i===u)return;let s=(r.x===o?0:2)|Number(r.y&l),a=i;return f&&m(i)&&(a=function(t){return m(t)?d(-t):t}(i),s^=1),new x(o,a,s)}}}(t,e,r),f=n;return o.createHmacDrbg(f.hash.outputLen,f.nByteLength,f.hmac)(s,c)},verify:function(t,r,o,s=L){const a=t;if(r=(0,i.ensureBytes)("msgHash",r),o=(0,i.ensureBytes)("publicKey",o),"strict"in s)throw new Error("options.strict was renamed to lowS");const{lowS:c,prehash:u}=s;let l,f;try{if("string"==typeof a||a instanceof Uint8Array)try{l=x.fromDER(a)}catch(t){if(!(t instanceof e.DER.Err))throw t;l=x.fromCompact(a)}else{if("object"!=typeof a||"bigint"!=typeof a.r||"bigint"!=typeof a.s)throw new Error("PARSE");{const{r:t,s:e}=a;l=new x(t,e)}}f=b.fromHex(o)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&l.hasHighS())return!1;u&&(r=n.hash(r));const{r:h,s:p}=l,g=A(r),_=y(p),w=d(g*_),v=d(h*_),m=b.BASE.multiplyAndAddUnsafe(f,w,v)?.toAffine();return!!m&&d(m.x)===h},ProjectivePoint:b,Signature:x,utils:O}},e.SWUFpSqrtRatio=y,e.mapToCurveSimpleSWU=function(t,e){if(r.validateField(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=y(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let o,i,s,a,c,u,l,f;o=t.sqr(r),o=t.mul(o,e.Z),i=t.sqr(o),i=t.add(i,o),s=t.add(i,t.ONE),s=t.mul(s,e.B),a=t.cmov(e.Z,t.neg(i),!t.eql(i,t.ZERO)),a=t.mul(a,e.A),i=t.sqr(s),u=t.sqr(a),c=t.mul(u,e.A),i=t.add(i,c),i=t.mul(i,s),u=t.mul(u,a),c=t.mul(u,e.B),i=t.add(i,c),l=t.mul(o,s);const{isValid:h,value:d}=n(i,u);f=t.mul(o,r),f=t.mul(f,d),l=t.cmov(l,s,h),f=t.cmov(f,d,h);const p=t.isOdd(r)===t.isOdd(f);return f=t.cmov(t.neg(f),f,p),l=t.div(l,a),{x:l,y:f}}}},3150:(t,e)=>{"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=o,e.hash=i,e.exists=s,e.output=a;const c={number:n,bool:r,bytes:o,hash:i,exists:s,output:a};e.default=c},8783:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(3150),o=n(1717);class i extends o.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,o.createView)(this.buffer)}update(t){(0,r.exists)(this);const{view:e,buffer:n,blockLen:i}=this,s=(t=(0,o.toBytes)(t)).length;for(let r=0;r<s;){const a=Math.min(i-this.pos,s-r);if(a!==i)n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===i&&(this.process(e,0),this.pos=0);else{const e=(0,o.createView)(t);for(;i<=s-r;r+=i)this.process(e,r)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,r.exists)(this),(0,r.output)(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:i,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let t=a;t<i;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,i-8,BigInt(8*this.length),s),this.process(n,0);const c=(0,o.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<l;t++)c.setUint32(4*t,f[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}e.SHA2=i},7564:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},1128:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const r=n(3150),o=n(1717);class i extends o.Hash{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,r.hash)(t);const n=(0,o.toBytes)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let t=0;t<s.length;t++)s[t]^=54;this.iHash.update(s),this.oHash=t.create();for(let t=0;t<s.length;t++)s[t]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,r.exists)(this),this.iHash.update(t),this}digestInto(t){(0,r.exists)(this),(0,r.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=i,e.hmac=(t,e,n)=>new i(t,e).update(n).digest(),e.hmac.create=(t,e)=>new i(t,e)},7968:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(8783),o=n(1717),i=(t,e,n)=>t&e^t&n^e&n,s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class u extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)c[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=c[t-15],n=c[t-2],r=(0,o.rotr)(e,7)^(0,o.rotr)(e,18)^e>>>3,i=(0,o.rotr)(n,17)^(0,o.rotr)(n,19)^n>>>10;c[t]=i+c[t-7]+r+c[t-16]|0}let{A:n,B:r,C:a,D:u,E:l,F:f,G:h,H:d}=this;for(let t=0;t<64;t++){const e=d+((0,o.rotr)(l,6)^(0,o.rotr)(l,11)^(0,o.rotr)(l,25))+((p=l)&f^~p&h)+s[t]+c[t]|0,y=((0,o.rotr)(n,2)^(0,o.rotr)(n,13)^(0,o.rotr)(n,22))+i(n,r,a)|0;d=h,h=f,f=l,l=u+e|0,u=a,a=r,r=n,n=e+y|0}var p;n=n+this.A|0,r=r+this.B|0,a=a+this.C|0,u=u+this.D|0,l=l+this.E|0,f=f+this.F|0,h=h+this.G|0,d=d+this.H|0,this.set(n,r,a,u,l,f,h,d)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class l extends u{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,o.wrapConstructor)((()=>new u)),e.sha224=(0,o.wrapConstructor)((()=>new l))},1717:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(7564),o=t=>t instanceof Uint8Array;if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.rotr=(t,e)=>t<<32-e|t>>>e,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const i=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function s(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function a(t){if("string"==typeof t&&(t=s(t)),!o(t))throw new Error("expected Uint8Array, got "+typeof t);return t}e.bytesToHex=function(t){if(!o(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=i[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let i=0;i<t;i++){r(i);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=s,e.toBytes=a,e.concatBytes=function(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let n=0;return t.forEach((t=>{if(!o(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length})),e},e.Hash=class{clone(){return this._cloneInto()}};const c={}.toString;e.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==c.call(e))throw new Error("Options should be object or undefined");return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(a(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.wrapXOFConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}},3497:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encodeToCurve=e.hashToCurve=e.schnorr=e.secp256k1=void 0;const r=n(7968),o=n(1717),i=n(4632),s=n(6551),a=n(219),c=n(5134),u=n(9082),l=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),f=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h=BigInt(1),d=BigInt(2),p=(t,e)=>(t+e/d)/e;function y(t){const e=l,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),a=BigInt(23),c=BigInt(44),u=BigInt(88),f=t*t*t%e,h=f*f*t%e,p=(0,i.pow2)(h,n,e)*h%e,y=(0,i.pow2)(p,n,e)*h%e,g=(0,i.pow2)(y,d,e)*f%e,_=(0,i.pow2)(g,o,e)*g%e,w=(0,i.pow2)(_,s,e)*_%e,v=(0,i.pow2)(w,c,e)*w%e,m=(0,i.pow2)(v,u,e)*v%e,E=(0,i.pow2)(m,c,e)*w%e,x=(0,i.pow2)(E,n,e)*h%e,O=(0,i.pow2)(x,a,e)*_%e,B=(0,i.pow2)(O,r,e)*f%e,S=(0,i.pow2)(B,d,e);if(!b.eql(b.sqr(S),t))throw new Error("Cannot find square root");return S}const b=(0,i.Field)(l,void 0,void 0,{sqrt:y});e.secp256k1=(0,u.createCurve)({a:BigInt(0),b:BigInt(7),Fp:b,n:f,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=f,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-h*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,a=BigInt("0x100000000000000000000000000000000"),c=p(s*t,e),u=p(-r*t,e);let l=(0,i.mod)(t-c*n-u*o,e),d=(0,i.mod)(-c*r-u*s,e);const y=l>a,b=d>a;if(y&&(l=e-l),b&&(d=e-d),l>a||d>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:y,k1:l,k2neg:b,k2:d}}}},r.sha256);const g=BigInt(0),_=t=>"bigint"==typeof t&&g<t&&t<l,w=t=>"bigint"==typeof t&&g<t&&t<f,v={};function m(t,...e){let n=v[t];if(void 0===n){const e=(0,r.sha256)(Uint8Array.from(t,(t=>t.charCodeAt(0))));n=(0,a.concatBytes)(e,e),v[t]=n}return(0,r.sha256)((0,a.concatBytes)(n,...e))}const E=t=>t.toRawBytes(!0).slice(1),x=t=>(0,a.numberToBytesBE)(t,32),O=t=>(0,i.mod)(t,l),B=t=>(0,i.mod)(t,f),S=e.secp256k1.ProjectivePoint,A=(t,e,n)=>S.BASE.multiplyAndAddUnsafe(t,e,n);function k(t){let n=e.secp256k1.utils.normPrivateKeyToScalar(t),r=S.fromPrivateKey(n);return{scalar:r.hasEvenY()?n:B(-n),bytes:E(r)}}function T(t){if(!_(t))throw new Error("bad x: need 0 < x < p");const e=O(t*t);let n=y(O(e*t+BigInt(7)));n%d!==g&&(n=O(-n));const r=new S(t,n,h);return r.assertValidity(),r}function I(...t){return B((0,a.bytesToNumberBE)(m("BIP0340/challenge",...t)))}function L(t,e,n){const r=(0,a.ensureBytes)("signature",t,64),o=(0,a.ensureBytes)("message",e),i=(0,a.ensureBytes)("publicKey",n,32);try{const t=T((0,a.bytesToNumberBE)(i)),e=(0,a.bytesToNumberBE)(r.subarray(0,32));if(!_(e))return!1;const n=(0,a.bytesToNumberBE)(r.subarray(32,64));if(!w(n))return!1;const s=I(x(e),E(t),o),c=A(t,n,B(-s));return!(!c||!c.hasEvenY()||c.toAffine().x!==e)}catch(t){return!1}}e.schnorr={getPublicKey:function(t){return k(t).bytes},sign:function(t,e,n=(0,o.randomBytes)(32)){const r=(0,a.ensureBytes)("message",t),{bytes:i,scalar:s}=k(e),c=(0,a.ensureBytes)("auxRand",n,32),u=x(s^(0,a.bytesToNumberBE)(m("BIP0340/aux",c))),l=m("BIP0340/nonce",u,i,r),f=B((0,a.bytesToNumberBE)(l));if(f===g)throw new Error("sign failed: k is zero");const{bytes:h,scalar:d}=k(f),p=I(h,i,r),y=new Uint8Array(64);if(y.set(h,0),y.set(x(B(d+p*s)),32),!L(y,r,i))throw new Error("sign: Invalid signature produced");return y},verify:L,utils:{randomPrivateKey:e.secp256k1.utils.randomPrivateKey,lift_x:T,pointToBytes:E,numberToBytesBE:a.numberToBytesBE,bytesToNumberBE:a.bytesToNumberBE,taggedHash:m,mod:i.mod}};const C=(()=>(0,c.isogenyMap)(b,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))))(),P=(()=>(0,s.mapToCurveSimpleSWU)(b,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:b.create(BigInt("-11"))}))(),j=(()=>(0,c.createHasher)(e.secp256k1.ProjectivePoint,(t=>{const{x:e,y:n}=P(b.create(t[0]));return C(e,n)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:b.ORDER,m:1,k:128,expand:"xmd",hash:r.sha256}))();e.hashToCurve=j.hashToCurve,e.encodeToCurve=j.encodeToCurve},7320:(t,e)=>{"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=o,e.hash=i,e.exists=s,e.output=a;const c={number:n,bool:r,bytes:o,hash:i,exists:s,output:a};e.default=c},7505:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(7320),o=n(8089);class i extends o.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,o.createView)(this.buffer)}update(t){r.default.exists(this);const{view:e,buffer:n,blockLen:i}=this,s=(t=(0,o.toBytes)(t)).length;for(let r=0;r<s;){const a=Math.min(i-this.pos,s-r);if(a!==i)n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===i&&(this.process(e,0),this.pos=0);else{const e=(0,o.createView)(t);for(;i<=s-r;r+=i)this.process(e,r)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){r.default.exists(this),r.default.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:i,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let t=a;t<i;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,i-8,BigInt(8*this.length),s),this.process(n,0);const c=(0,o.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<l;t++)c.setUint32(4*t,f[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}e.SHA2=i},1945:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},4330:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hkdf=e.expand=e.extract=void 0;const r=n(7320),o=n(8089),i=n(9569);function s(t,e,n){return r.default.hash(t),void 0===n&&(n=new Uint8Array(t.outputLen)),(0,i.hmac)(t,(0,o.toBytes)(n),(0,o.toBytes)(e))}e.extract=s;const a=new Uint8Array([0]),c=new Uint8Array;function u(t,e,n,o=32){if(r.default.hash(t),r.default.number(o),o>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(o/t.outputLen);void 0===n&&(n=c);const u=new Uint8Array(s*t.outputLen),l=i.hmac.create(t,e),f=l._cloneInto(),h=new Uint8Array(l.outputLen);for(let e=0;e<s;e++)a[0]=e+1,f.update(0===e?c:h).update(n).update(a).digestInto(h),u.set(h,t.outputLen*e),l._cloneInto(f);return l.destroy(),f.destroy(),h.fill(0),a.fill(0),u.slice(0,o)}e.expand=u,e.hkdf=(t,e,n,r,o)=>u(t,s(t,e,n),r,o)},9569:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const r=n(7320),o=n(8089);class i extends o.Hash{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,r.default.hash(t);const n=(0,o.toBytes)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let t=0;t<s.length;t++)s[t]^=54;this.iHash.update(s),this.oHash=t.create();for(let t=0;t<s.length;t++)s[t]^=106;this.oHash.update(s),s.fill(0)}update(t){return r.default.exists(this),this.iHash.update(t),this}digestInto(t){r.default.exists(this),r.default.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=i,e.hmac=(t,e,n)=>new i(t,e).update(n).digest(),e.hmac.create=(t,e)=>new i(t,e)},3061:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(7505),o=n(8089),i=(t,e,n)=>t&e^t&n^e&n,s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class u extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)c[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=c[t-15],n=c[t-2],r=(0,o.rotr)(e,7)^(0,o.rotr)(e,18)^e>>>3,i=(0,o.rotr)(n,17)^(0,o.rotr)(n,19)^n>>>10;c[t]=i+c[t-7]+r+c[t-16]|0}let{A:n,B:r,C:a,D:u,E:l,F:f,G:h,H:d}=this;for(let t=0;t<64;t++){const e=d+((0,o.rotr)(l,6)^(0,o.rotr)(l,11)^(0,o.rotr)(l,25))+((p=l)&f^~p&h)+s[t]+c[t]|0,y=((0,o.rotr)(n,2)^(0,o.rotr)(n,13)^(0,o.rotr)(n,22))+i(n,r,a)|0;d=h,h=f,f=l,l=u+e|0,u=a,a=r,r=n,n=e+y|0}var p;n=n+this.A|0,r=r+this.B|0,a=a+this.C|0,u=u+this.D|0,l=l+this.E|0,f=f+this.F|0,h=h+this.G|0,d=d+this.H|0,this.set(n,r,a,u,l,f,h,d)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class l extends u{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,o.wrapConstructor)((()=>new u)),e.sha224=(0,o.wrapConstructor)((()=>new l))},8089:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(1945),o=t=>t instanceof Uint8Array;if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.rotr=(t,e)=>t<<32-e|t>>>e,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const i=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function s(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function a(t){if("string"==typeof t&&(t=s(t)),!o(t))throw new Error("expected Uint8Array, got "+typeof t);return t}e.bytesToHex=function(t){if(!o(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=i[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let i=0;i<t;i++){r(i);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=s,e.toBytes=a,e.concatBytes=function(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let n=0;return t.forEach((t=>{if(!o(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length})),e},e.Hash=class{clone(){return this._cloneInto()}},e.checkOpts=function(t,e){if(void 0!==e&&("object"!=typeof e||(n=e,"[object Object]"!==Object.prototype.toString.call(n)||n.constructor!==Object)))throw new Error("Options should be object or undefined");var n;return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(a(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.wrapXOFConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}},9187:(t,e)=>{"use strict";function n(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function r(...t){const e=(t,e)=>n=>t(e(n));return{encode:Array.from(t).reverse().reduce(((t,n)=>t?e(t,n.encode):n.encode),void 0),decode:t.reduce(((t,n)=>t?e(t,n.decode):n.decode),void 0)}}function o(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map((e=>{if(n(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]}))},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map((e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const n=t.indexOf(e);if(-1===n)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return n}))}}}function i(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let t of e)if("string"!=typeof t)throw new Error(`join.encode: non-string input=${t}`);return e.join(t)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(t)}}}function s(t,e="="){if(n(t),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.encode: non-string input=${t}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.decode: non-string input=${t}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function a(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:t=>t,decode:e=>t(e)}}function c(t,e,r){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let o=0;const i=[],s=Array.from(t);for(s.forEach((t=>{if(n(t),t<0||t>=e)throw new Error(`Wrong integer: ${t}`)}));;){let t=0,n=!0;for(let i=o;i<s.length;i++){const a=s[i],c=e*t+a;if(!Number.isSafeInteger(c)||e*t/e!==t||c-a!=e*t)throw new Error("convertRadix: carry overflow");if(t=c%r,s[i]=Math.floor(c/r),!Number.isSafeInteger(s[i])||s[i]*r+t!==c)throw new Error("convertRadix: carry overflow");n&&(s[i]?n=!1:o=i)}if(i.push(t),n)break}for(let e=0;e<t.length-1&&0===t[e];e++)i.push(0);return i.reverse()}Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0,e.assertNumber=n;const u=(t,e)=>e?u(e,t%e):t,l=(t,e)=>t+(e-u(t,e));function f(t,e,r,o){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(l(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${l(e,r)}`);let i=0,s=0;const a=2**r-1,c=[];for(const o of t){if(n(o),o>=2**e)throw new Error(`convertRadix2: invalid data word=${o} from=${e}`);if(i=i<<e|o,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=r;s-=r)c.push((i>>s-r&a)>>>0);i&=2**s-1}if(i=i<<r-s&a,!o&&s>=e)throw new Error("Excess padding");if(!o&&i)throw new Error(`Non-zero padding: ${i}`);return o&&s>0&&c.push(i>>>0),c}function h(t){return n(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return c(Array.from(e),256,t)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(c(e,t,256))}}}function d(t,e=!1){if(n(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(l(8,t)>32||l(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return f(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(f(n,t,8,e))}}}function p(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch(t){}}}function y(t,e){if(n(t),"function"!=typeof e)throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=e(n).slice(0,t),o=new Uint8Array(n.length+t);return o.set(n),o.set(r,n.length),o},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-t),o=e(r).slice(0,t),i=n.slice(-t);for(let e=0;e<t;e++)if(o[e]!==i[e])throw new Error("Invalid checksum");return r}}}e.utils={alphabet:o,chain:r,checksum:y,radix:h,radix2:d,join:i,padding:s},e.base16=r(d(4),o("0123456789ABCDEF"),i("")),e.base32=r(d(5),o("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),s(5),i("")),e.base32hex=r(d(5),o("0123456789ABCDEFGHIJKLMNOPQRSTUV"),s(5),i("")),e.base32crockford=r(d(5),o("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),i(""),a((t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),e.base64=r(d(6),o("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),s(6),i("")),e.base64url=r(d(6),o("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),s(6),i(""));const b=t=>r(h(58),o(t),i(""));e.base58=b("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=b("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=b("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const g=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(t){let n="";for(let r=0;r<t.length;r+=8){const o=t.subarray(r,r+8);n+=e.base58.encode(o).padStart(g[o.length],"1")}return n},decode(t){let n=[];for(let r=0;r<t.length;r+=11){const o=t.slice(r,r+11),i=g.indexOf(o.length),s=e.base58.decode(o);for(let t=0;t<s.length-i;t++)if(0!==s[t])throw new Error("base58xmr: wrong padding");n=n.concat(Array.from(s.slice(s.length-i)))}return Uint8Array.from(n)}},e.base58check=t=>r(y(4,(e=>t(t(e)))),e.base58);const _=r(o("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),i("")),w=[996825010,642813549,513874426,1027748829,705979059];function v(t){const e=t>>25;let n=(33554431&t)<<5;for(let t=0;t<w.length;t++)1==(e>>t&1)&&(n^=w[t]);return n}function m(t,e,n=1){const r=t.length;let o=1;for(let e=0;e<r;e++){const n=t.charCodeAt(e);if(n<33||n>126)throw new Error(`Invalid prefix (${t})`);o=v(o)^n>>5}o=v(o);for(let e=0;e<r;e++)o=v(o)^31&t.charCodeAt(e);for(let t of e)o=v(o)^t;for(let t=0;t<6;t++)o=v(o);return o^=n,_.encode(f([o%2**30],30,5,!1))}function E(t){const e="bech32"===t?1:734539939,n=d(5),r=n.decode,o=n.encode,i=p(r);function s(t,n=90){if("string"!=typeof t)throw new Error("bech32.decode input should be string, not "+typeof t);if(t.length<8||!1!==n&&t.length>n)throw new TypeError(`Wrong string length: ${t.length} (${t}). Expected (8..${n})`);const r=t.toLowerCase();if(t!==r&&t!==t.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(t=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=t.slice(0,o),s=t.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=_.decode(s).slice(0,-6),c=m(i,a,e);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${t}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(t,n,r=90){if("string"!=typeof t)throw new Error("bech32.encode prefix should be string, not "+typeof t);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=t.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${t=t.toLowerCase()}1${_.encode(n)}${m(t,n,e)}`},decode:s,decodeToBytes:function(t){const{prefix:e,words:n}=s(t,!1);return{prefix:e,words:n,bytes:r(n)}},decodeUnsafe:p(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}e.bech32=E("bech32"),e.bech32m=E("bech32m"),e.utf8={encode:t=>(new TextDecoder).decode(t),decode:t=>(new TextEncoder).encode(t)},e.hex=r(d(4),o("0123456789abcdef"),i(""),a((t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})));const x={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},O=`Invalid encoding type. Available types: ${Object.keys(x).join(", ")}`;e.bytesToString=(t,e)=>{if("string"!=typeof t||!x.hasOwnProperty(t))throw new TypeError(O);if(!(e instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return x[t].encode(e)},e.str=e.bytesToString,e.stringToBytes=(t,e)=>{if(!x.hasOwnProperty(t))throw new TypeError(O);if("string"!=typeof e)throw new TypeError("stringToBytes() expects string");return x[t].decode(e)},e.bytes=e.stringToBytes},284:t=>{var e=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}()},8519:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=n(9381);n(6445),(()=>{const t=["wss://relay-jp.nostr.wirednet.jp","wss://yabu.me","wss://nos.lol","wss://relay.damus.io"],e=new Intl.DateTimeFormat("ja-jp",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),n=new o.SimplePool;if("object"!=typeof window)return;const i=document.getElementById("relays-read");i.value=t.join("\n");const s=document.getElementById("relays-write");s.value=t.join("\n"),document.getElementById("login").addEventListener("click",(()=>r(void 0,void 0,void 0,(function*(){if(void 0!==window.nostr){const t=yield window.nostr.getPublicKey();void 0!==t&&(document.getElementById("npub").value=o.nip19.npubEncode(t))}}))));const a=document.getElementById("get-relays");a.addEventListener("click",(()=>{const e=document.querySelector("#get-relays + .status");let r;try{r=l("npub")}catch(t){return void(e.textContent=t.message)}e.textContent="...",a.disabled=!0;const o={kinds:[10002],authors:[r]},c=[],u=n.subscribeMany(t,[o],{onevent:t=>{c.push(t)},oneose:()=>{if(u.close(),a.disabled=!1,0===c.length)return void(e.textContent="kind10002");const t=c.reduce(((t,e)=>t.created_at>e.created_at?t:e));e.textContent=`${t.tags.filter((t=>t.length>=2&&"r"===t[0])).length}`;const n=[],r=[];for(const e of t.tags.filter((t=>t.length>=2&&"r"===t[0])))2!==e.length&&"read"!==e[2]||n.push(e[1]),2!==e.length&&"write"!==e[2]||r.push(e[1]);i.value=n.join("\n"),s.value=r.join("\n")}})}));const c=document.getElementById("send-dm");c.addEventListener("click",(()=>r(void 0,void 0,void 0,(function*(){if(void 0===window.nostr)return;const t=document.querySelector("#send-dm + .status");let e;try{e=l("npub-send")}catch(e){return void(t.textContent=e.message)}const r=document.getElementById("message"),o=r.value;if(""===o)return void(t.textContent="message is empty");t.textContent="...",c.disabled=!0;const i=s.value.split("\n"),a={kind:4,created_at:Math.floor(Date.now()/1e3),tags:[["p",e]],content:yield window.nostr.nip04.encrypt(e,o),pubkey:yield window.nostr.getPublicKey()},u=yield window.nostr.signEvent(a),f=n.publish(i,u);yield Promise.all(f),r.value="",t.textContent="",c.disabled=!1}))));const u=document.getElementById("receive-dm");u.addEventListener("click",(()=>{const t=document.querySelector("#receive-dm + .status");let s;try{s=l("npub")}catch(e){return void(t.textContent=e.message)}const a=document.getElementById("dm");a.innerHTML="",t.textContent="...",u.disabled=!0;const c=i.value.split("\n"),f=[{kinds:[4],authors:[s]},{kinds:[4],"#p":[s]}];let h=[];const d=n.subscribeMany(c,f,{onevent:t=>{h=o.utils.insertEventIntoDescendingList(h,t)},oneose:()=>{d.close();const o=new Set([...h.map((t=>t.pubkey)),...h.map((t=>{var e,n;return null!==(n=null===(e=t.tags.find((t=>t.length>=2&&"p"===t[0])))||void 0===e?void 0:e.at(1))&&void 0!==n?n:""}))]),i={kinds:[0],authors:Array.from(o)},s=[],l=n.subscribeMany(c,[i],{onevent:t=>{s.push(t)},oneose:()=>{var n,o,i,c,f,d,p,y,b,g,_,w;l.close(),t.textContent=`${h.length}`,u.disabled=!1;const v={};for(const t of s)if(v[t.pubkey]&&v[t.pubkey].created_at<t.created_at||!v[t.pubkey]){try{v[t.pubkey]=JSON.parse(t.content)}catch(t){console.warn(t);continue}v[t.pubkey].created_at=t.created_at}for(const t of h){const s=document.createElement("time");s.textContent=e.format(new Date(1e3*t.created_at));const u=document.createElement("dt");if(void 0!==(null===(n=v[t.pubkey])||void 0===n?void 0:n.picture)){const e=document.createElement("img");e.src=v[t.pubkey].picture,u.appendChild(e)}const l=null!==(i=null===(o=t.tags.find((t=>t.length>=2&&"p"===t[0])))||void 0===o?void 0:o.at(1))&&void 0!==i?i:"";if(u.appendChild(document.createTextNode(` ${null!==(f=null===(c=v[t.pubkey])||void 0===c?void 0:c.display_name)&&void 0!==f?f:""} @${null!==(p=null===(d=v[t.pubkey])||void 0===d?void 0:d.name)&&void 0!==p?p:""} to `)),void 0!==(null===(y=v[l])||void 0===y?void 0:y.picture)){const t=document.createElement("img");t.src=v[l].picture,u.appendChild(t)}u.appendChild(document.createTextNode(` ${null!==(g=null===(b=v[l])||void 0===b?void 0:b.display_name)&&void 0!==g?g:""} @${null!==(w=null===(_=v[l])||void 0===_?void 0:_.name)&&void 0!==w?w:""} `)),u.appendChild(s);const h=document.createElement("button");h.textContent="",h.addEventListener("click",(()=>r(void 0,void 0,void 0,(function*(){if(void 0===window.nostr)return;const e=(yield window.nostr.getPublicKey())===t.pubkey?l:t.pubkey;k.textContent=yield window.nostr.nip04.decrypt(e,t.content)}))));const m=document.createElement("details"),E=document.createElement("summary");E.textContent="{}";const x=document.createElement("dl"),O=document.createElement("dt");O.textContent="Event JSON";const B=document.createElement("dd"),S=document.createElement("pre"),A=document.createElement("code");A.textContent=JSON.stringify(t,void 0,2),S.appendChild(A),B.appendChild(S),x.appendChild(O),x.appendChild(B),m.appendChild(E),m.appendChild(x);const k=document.createElement("dd");k.appendChild(h),k.appendChild(document.createTextNode(t.content)),k.appendChild(m),a.appendChild(u),a.appendChild(k)}}})}})}));const l=t=>{const e=document.getElementById(t).value;if(""===e)throw new Error("npub is empty");const n=o.nip19.decode(e);if("npub"!==n.type)throw new Error(`${e} is not npub`);return n.data}})()},2278:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var o=n(7428),i=function(){function t(){}return t.prototype.empty=function(){return 0===this.size()},t.prototype.rbegin=function(){return this.end().reverse()},t.prototype.rend=function(){return this.begin().reverse()},t.prototype[Symbol.iterator]=function(){return new o.ForOfAdaptor(this.begin(),this.end())},t.prototype.toJSON=function(){var t,e,n=[];try{for(var o=r(this),i=o.next();!i.done;i=o.next()){var s=i.value;n.push(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},t}();e.Container=i},9683:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.MapContainer=void 0;var i=n(2278),s=n(9932),a=function(t){function e(e){var n=t.call(this)||this;return n.data_=e(n),n}return o(e,t),e.prototype.assign=function(t,e){this.clear(),this.insert(t,e)},e.prototype.clear=function(){this.data_.clear()},e.prototype.begin=function(){return this.data_.begin()},e.prototype.end=function(){return this.data_.end()},e.prototype.has=function(t){return!this.find(t).equals(this.end())},e.prototype.size=function(){return this.data_.size()},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=new s.NativeArrayIterator(t,0),r=new s.NativeArrayIterator(t,t.length);return this.insert(n,r),this.size()},e.prototype.insert=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length?this.emplace(t[0].first,t[0].second):t[0].next instanceof Function&&t[1].next instanceof Function?this._Insert_by_range(t[0],t[1]):this.emplace_hint(t[0],t[1].first,t[1].second)},e.prototype.erase=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1!==t.length||t[0]instanceof this.end().constructor!=0&&t[0].source()===this?1===t.length?this._Erase_by_range(t[0]):this._Erase_by_range(t[0],t[1]):this._Erase_by_key(t[0])},e.prototype._Erase_by_range=function(t,e){void 0===e&&(e=t.next());var n=this.data_.erase(t,e);return this._Handle_erase(t,e),n},e}(i.Container);e.MapContainer=a},6639:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SetContainer=void 0;var i=n(2278),s=n(9932),a=function(t){function e(e){var n=t.call(this)||this;return n.data_=e(n),n}return o(e,t),e.prototype.assign=function(t,e){this.clear(),this.insert(t,e)},e.prototype.clear=function(){this.data_.clear()},e.prototype.begin=function(){return this.data_.begin()},e.prototype.end=function(){return this.data_.end()},e.prototype.has=function(t){return!this.find(t).equals(this.end())},e.prototype.size=function(){return this.data_.size()},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)return this.size();var n=new s.NativeArrayIterator(t,0),r=new s.NativeArrayIterator(t,t.length);return this._Insert_by_range(n,r),this.size()},e.prototype.insert=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length?this._Insert_by_key(t[0]):t[0].next instanceof Function&&t[1].next instanceof Function?this._Insert_by_range(t[0],t[1]):this._Insert_by_hint(t[0],t[1])},e.prototype.erase=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1!==t.length||t[0]instanceof this.end().constructor&&t[0].source()===this?1===t.length?this._Erase_by_range(t[0]):this._Erase_by_range(t[0],t[1]):this._Erase_by_val(t[0])},e.prototype._Erase_by_range=function(t,e){void 0===e&&(e=t.next());var n=this.data_.erase(t,e);return this._Handle_erase(t,e),n},e}(i.Container);e.SetContainer=a},1571:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.UniqueMap=void 0;var a=n(9683),c=n(1566),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.count=function(t){return this.find(t).equals(this.end())?0:1},e.prototype.get=function(t){var e=this.find(t);if(!0===e.equals(this.end()))throw c.ErrorGenerator.key_nout_found(this,"get",t);return e.second},e.prototype.take=function(t,e){var n=this.find(t);return n.equals(this.end())?this.emplace(t,e()).first.second:n.second},e.prototype.set=function(t,e){this.insert_or_assign(t,e)},e.prototype.insert=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.prototype.insert.apply(this,s([],i(e),!1))},e.prototype._Insert_by_range=function(t,e){for(var n=t;!n.equals(e);n=n.next())this.emplace(n.value.first,n.value.second)},e.prototype.insert_or_assign=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 2===t.length?this._Insert_or_assign_with_key_value(t[0],t[1]):3===t.length?this._Insert_or_assign_with_hint(t[0],t[1],t[2]):void 0},e.prototype._Insert_or_assign_with_key_value=function(t,e){var n=this.emplace(t,e);return!1===n.second&&(n.first.second=e),n},e.prototype._Insert_or_assign_with_hint=function(t,e,n){var r=this.emplace_hint(t,e,n);return r.second!==n&&(r.second=n),r},e.prototype.extract=function(t){return t instanceof this.end().constructor?this._Extract_by_iterator(t):this._Extract_by_key(t)},e.prototype._Extract_by_key=function(t){var e=this.find(t);if(!0===e.equals(this.end()))throw c.ErrorGenerator.key_nout_found(this,"extract",t);var n=e.value;return this._Erase_by_range(e),n},e.prototype._Extract_by_iterator=function(t){return!0===t.equals(this.end())?this.end():(this._Erase_by_range(t),t)},e.prototype._Erase_by_key=function(t){var e=this.find(t);return!0===e.equals(this.end())?0:(this._Erase_by_range(e),1)},e.prototype.merge=function(t){for(var e=t.begin();!e.equals(t.end());)!1===this.has(e.first)?(this.insert(e.value),e=t.erase(e)):e=e.next()},e}(a.MapContainer);e.UniqueMap=u},2570:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.UniqueSet=void 0;var a=n(6639),c=n(1566),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.count=function(t){return this.find(t).equals(this.end())?0:1},e.prototype.insert=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.prototype.insert.apply(this,s([],i(e),!1))},e.prototype._Insert_by_range=function(t,e){for(;!t.equals(e);t=t.next())this._Insert_by_key(t.value)},e.prototype.extract=function(t){return t instanceof this.end().constructor?this._Extract_by_iterator(t):this._Extract_by_val(t)},e.prototype._Extract_by_val=function(t){var e=this.find(t);if(!0===e.equals(this.end()))throw c.ErrorGenerator.key_nout_found(this,"extract",t);return this._Erase_by_range(e),t},e.prototype._Extract_by_iterator=function(t){return!0===t.equals(this.end())||!1===this.has(t.value)?this.end():(this._Erase_by_range(t),t)},e.prototype._Erase_by_val=function(t){var e=this.find(t);return!0===e.equals(this.end())?0:(this._Erase_by_range(e),1)},e.prototype.merge=function(t){for(var e=t.begin();!e.equals(t.end());)!1===this.has(e.value)?(this.insert(e.value),e=t.erase(e)):e=e.next()},e}(a.SetContainer);e.UniqueSet=u},1266:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.HashMap=void 0;var a=n(1571),c=n(4970),u=n(9753),l=n(3136),f=n(9430),h=n(5351),d=function(t){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.call(this,(function(t){return new u.MapElementList(t)}))||this;return c.IHashContainer.construct.apply(c.IHashContainer,s([o,e,function(t,e){o.buckets_=new l.MapHashBuckets(o,t,e)}],i(n),!1)),o}return o(e,t),e.prototype.clear=function(){this.buckets_.clear(),t.prototype.clear.call(this)},e.prototype.swap=function(t){var e,n;e=i([t.data_,this.data_],2),this.data_=e[0],t.data_=e[1],u.MapElementList._Swap_associative(this.data_,t.data_),l.MapHashBuckets._Swap_source(this.buckets_,t.buckets_),n=i([t.buckets_,this.buckets_],2),this.buckets_=n[0],t.buckets_=n[1]},e.prototype.find=function(t){return this.buckets_.find(t)},e.prototype.begin=function(e){return void 0===e&&(e=null),null===e?t.prototype.begin.call(this):this.buckets_.at(e)[0]},e.prototype.end=function(e){if(void 0===e&&(e=null),null===e)return t.prototype.end.call(this);var n=this.buckets_.at(e);return n[n.length-1].next()},e.prototype.rbegin=function(t){return void 0===t&&(t=null),this.end(t).reverse()},e.prototype.rend=function(t){return void 0===t&&(t=null),this.begin(t).reverse()},e.prototype.bucket_count=function(){return this.buckets_.length()},e.prototype.bucket_size=function(t){return this.buckets_.at(t).length},e.prototype.load_factor=function(){return this.buckets_.load_factor()},e.prototype.hash_function=function(){return this.buckets_.hash_function()},e.prototype.key_eq=function(){return this.buckets_.key_eq()},e.prototype.bucket=function(t){return this.hash_function()(t)%this.buckets_.length()},e.prototype.max_load_factor=function(t){return void 0===t&&(t=null),this.buckets_.max_load_factor(t)},e.prototype.reserve=function(t){this.buckets_.reserve(t)},e.prototype.rehash=function(t){this.buckets_.rehash(t)},e.prototype.emplace=function(t,e){var n=this.find(t);return!1===n.equals(this.end())?new h.Pair(n,!1):(this.data_.push(new f.Entry(t,e)),n=n.prev(),this._Handle_insert(n,n.next()),new h.Pair(n,!0))},e.prototype.emplace_hint=function(t,e,n){var r=this.find(e);return!0===r.equals(this.end())&&(r=this.data_.insert(t,new f.Entry(e,n)),this._Handle_insert(r,r.next())),r},e.prototype._Handle_insert=function(t,e){for(;!t.equals(e);t=t.next())this.buckets_.insert(t)},e.prototype._Handle_erase=function(t,e){for(;!t.equals(e);t=t.next())this.buckets_.erase(t)},e}(a.UniqueMap);e.HashMap=d,function(t){t.Iterator=u.MapElementList.Iterator,t.ReverseIterator=u.MapElementList.ReverseIterator}(d=e.HashMap||(e.HashMap={})),e.HashMap=d},5017:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.HashSet=void 0;var a=n(2570),c=n(4970),u=n(7976),l=n(6449),f=n(5351),h=function(t){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.call(this,(function(t){return new u.SetElementList(t)}))||this;return c.IHashContainer.construct.apply(c.IHashContainer,s([o,e,function(t,e){o.buckets_=new l.SetHashBuckets(o,t,e)}],i(n),!1)),o}return o(e,t),e.prototype.clear=function(){this.buckets_.clear(),t.prototype.clear.call(this)},e.prototype.swap=function(t){var e,n;e=i([t.data_,this.data_],2),this.data_=e[0],t.data_=e[1],u.SetElementList._Swap_associative(this.data_,t.data_),l.SetHashBuckets._Swap_source(this.buckets_,t.buckets_),n=i([t.buckets_,this.buckets_],2),this.buckets_=n[0],t.buckets_=n[1]},e.prototype.find=function(t){return this.buckets_.find(t)},e.prototype.begin=function(e){return void 0===e&&(e=null),null===e?t.prototype.begin.call(this):this.buckets_.at(e)[0]},e.prototype.end=function(e){if(void 0===e&&(e=null),null===e)return t.prototype.end.call(this);var n=this.buckets_.at(e);return n[n.length-1].next()},e.prototype.rbegin=function(t){return void 0===t&&(t=null),this.end(t).reverse()},e.prototype.rend=function(t){return void 0===t&&(t=null),this.begin(t).reverse()},e.prototype.bucket_count=function(){return this.buckets_.length()},e.prototype.bucket_size=function(t){return this.buckets_.at(t).length},e.prototype.load_factor=function(){return this.buckets_.load_factor()},e.prototype.hash_function=function(){return this.buckets_.hash_function()},e.prototype.key_eq=function(){return this.buckets_.key_eq()},e.prototype.bucket=function(t){return this.hash_function()(t)%this.buckets_.length()},e.prototype.max_load_factor=function(t){return void 0===t&&(t=null),this.buckets_.max_load_factor(t)},e.prototype.reserve=function(t){this.buckets_.reserve(t)},e.prototype.rehash=function(t){this.buckets_.rehash(t)},e.prototype._Insert_by_key=function(t){var e=this.find(t);return!1===e.equals(this.end())?new f.Pair(e,!1):(this.data_.push(t),e=e.prev(),this._Handle_insert(e,e.next()),new f.Pair(e,!0))},e.prototype._Insert_by_hint=function(t,e){var n=this.find(e);return!0===n.equals(this.end())&&(n=this.data_.insert(t,e),this._Handle_insert(n,n.next())),n},e.prototype._Handle_insert=function(t,e){for(;!t.equals(e);t=t.next())this.buckets_.insert(t)},e.prototype._Handle_erase=function(t,e){for(;!t.equals(e);t=t.next())this.buckets_.erase(t)},e}(a.UniqueSet);e.HashSet=h,function(t){t.Iterator=u.SetElementList.Iterator,t.ReverseIterator=u.SetElementList.ReverseIterator}(h=e.HashSet||(e.HashSet={})),e.HashSet=h},269:function(t,e){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Exception=void 0;var o=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this,o=n.prototype;return Object.setPrototypeOf?Object.setPrototypeOf(r,o):r.__proto__=o,r}return r(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this.constructor.name},enumerable:!1,configurable:!0}),e.prototype.what=function(){return this.message},e.prototype.toJSON=function(){return{name:this.name,message:this.message,stack:this.stack}},e}(Error);e.Exception=o},9014:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidArgument=void 0;var i=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e}(n(5501).LogicError);e.InvalidArgument=i},5501:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.LogicError=void 0;var i=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e}(n(269).Exception);e.LogicError=i},7632:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.OutOfRange=void 0;var i=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e}(n(5501).LogicError);e.OutOfRange=i},8925:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.greater_equal=e.greater=e.less_equal=e.less=e.not_equal_to=e.equal_to=void 0;var r=n(4682);function o(t,e){return t=t?t.valueOf():t,e=e?e.valueOf():e,t instanceof Object&&t.equals instanceof Function?t.equals(e):t===e}function i(t,e){return t=t.valueOf(),e=e.valueOf(),t instanceof Object?t.less instanceof Function?t.less(e):(0,r.get_uid)(t)<(0,r.get_uid)(e):t<e}function s(t,e){return i(t,e)||o(t,e)}e.equal_to=o,e.not_equal_to=function(t,e){return!o(t,e)},e.less=i,e.less_equal=s,e.greater=function(t,e){return!s(t,e)},e.greater_equal=function(t,e){return!i(t,e)}},9029:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.hash=void 0;var o=n(4682);function i(t,e){return(e^=t?1:0)*u}function s(t,e){return a(t.toString(),e)}function a(t,e){for(var n=0;n<t.length;++n)e^=t.charCodeAt(n),e*=u;return Math.abs(e)}e.hash=function(){for(var t,e,n=[],l=0;l<arguments.length;l++)n[l]=arguments[l];var f=c;try{for(var h=r(n),d=h.next();!d.done;d=h.next()){var p=d.value,y=typeof(p=p?p.valueOf():p);if("boolean"===y)f=i(p,f);else if("number"===y||"bigint"===y)f=s(p,f);else if("string"===y)f=a(p,f);else if(p instanceof Object&&p.hashCode instanceof Function){var b=p.hashCode();if(1===n.length)return b;f^=b,f*=u}else f=s((0,o.get_uid)(p),f)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}return Math.abs(f)};var c=2166136261,u=16777619},4682:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get_uid=void 0;var r=n(4931);e.get_uid=function(t){if(t instanceof Object){if(!1===t.hasOwnProperty("__get_m_iUID")){var e=++(0,r._Get_root)().__s_iUID;Object.defineProperty(t,"__get_m_iUID",{value:function(){return e}})}return t.__get_m_iUID()}return void 0===t?-1:0}},4931:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._Get_root=void 0;var r=n(4922);e._Get_root=function(){return null===o&&void 0===(o=(0,r.is_node)()?n.g:self).__s_iUID&&(o.__s_iUID=0),o};var o=null},2644:function(t,e){"use strict";var n=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.IAssociativeContainer=void 0,(e.IAssociativeContainer||(e.IAssociativeContainer={})).construct=function(t){for(var e,o,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return i.length>=1&&i[0]instanceof Array?(e=function(){var e=i[0];t.push.apply(t,r([],n(e),!1))},o=i.slice(1)):i.length>=2&&i[0].next instanceof Function&&i[1].next instanceof Function?(e=function(){var e=i[0],n=i[1];t.assign(e,n)},o=i.slice(2)):(e=null,o=i),{ramda:e,tail:o}}},4970:function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},o=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.IHashContainer=void 0;var i=n(2644),s=n(9029),a=n(8925);(e.IHashContainer||(e.IHashContainer={})).construct=function(t,e,n){for(var c=[],u=3;u<arguments.length;u++)c[u-3]=arguments[u];var l=null,f=s.hash,h=a.equal_to;if(1===c.length&&c[0]instanceof e){var d=c[0];f=d.hash_function(),h=d.key_eq(),l=function(){var e=d.begin(),n=d.end();t.assign(e,n)}}else{var p=i.IAssociativeContainer.construct.apply(i.IAssociativeContainer,o([t],r(c),!1));l=p.ramda,p.tail.length>=1&&(f=p.tail[0]),p.tail.length>=2&&(h=p.tail[1])}n(f,h),null!==l&&l()}},9753:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.MapElementList=void 0;var s=n(7647),a=n(2918),c=n(5709),u=function(t){function e(e){var n=t.call(this)||this;return n.associative_=e,n}return o(e,t),e.prototype._Create_iterator=function(t,n,r){return e.Iterator.create(this,t,n,r)},e._Swap_associative=function(t,e){var n;n=i([e.associative_,t.associative_],2),t.associative_=n[0],e.associative_=n[1]},e.prototype.associative=function(){return this.associative_},e}(s.ListContainer);e.MapElementList=u,function(t){var e=function(t){function e(e,n,r,o){var i=t.call(this,n,r,o)||this;return i.list_=e,i}return o(e,t),e.create=function(t,n,r,o){return new e(t,n,r,o)},e.prototype.reverse=function(){return new n(this)},e.prototype.source=function(){return this.list_.associative()},Object.defineProperty(e.prototype,"first",{get:function(){return this.value.first},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.value.second},set:function(t){this.value.second=t},enumerable:!1,configurable:!0}),e}(a.ListIterator);t.Iterator=e;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype._Create_neighbor=function(t){return new e(t)},Object.defineProperty(e.prototype,"first",{get:function(){return this.base_.first},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this.base_.second},set:function(t){this.base_.second=t},enumerable:!1,configurable:!0}),e}(c.ReverseIterator);t.ReverseIterator=n}(u=e.MapElementList||(e.MapElementList={})),e.MapElementList=u},7976:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.SetElementList=void 0;var s=n(7647),a=n(2918),c=n(5709),u=function(t){function e(e){var n=t.call(this)||this;return n.associative_=e,n}return o(e,t),e.prototype._Create_iterator=function(t,n,r){return e.Iterator.create(this,t,n,r)},e._Swap_associative=function(t,e){var n;n=i([e.associative_,t.associative_],2),t.associative_=n[0],e.associative_=n[1]},e.prototype.associative=function(){return this.associative_},e}(s.ListContainer);e.SetElementList=u,function(t){var e=function(t){function e(e,n,r,o){var i=t.call(this,n,r,o)||this;return i.source_=e,i}return o(e,t),e.create=function(t,n,r,o){return new e(t,n,r,o)},e.prototype.reverse=function(){return new n(this)},e.prototype.source=function(){return this.source_.associative()},e}(a.ListIterator);t.Iterator=e;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype._Create_neighbor=function(t){return new e(t)},e}(c.ReverseIterator);t.ReverseIterator=n}(u=e.SetElementList||(e.SetElementList={})),e.SetElementList=u},7647:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.ListContainer=void 0;var s=n(2278),a=n(2918),c=n(7489),u=n(9932),l=n(6937),f=n(1566),h=function(t){function e(){var e=t.call(this)||this;return e.end_=e._Create_iterator(null,null),e.clear(),e}return o(e,t),e.prototype.assign=function(t,e){this.clear(),this.insert(this.end(),t,e)},e.prototype.clear=function(){a.ListIterator._Set_prev(this.end_,this.end_),a.ListIterator._Set_next(this.end_,this.end_),this.begin_=this.end_,this.size_=0},e.prototype.resize=function(t){var e=t-this.size();e>0?this.insert(this.end(),e,void 0):e<0&&this.erase((0,l.advance)(this.end(),-e),this.end())},e.prototype.begin=function(){return this.begin_},e.prototype.end=function(){return this.end_},e.prototype.size=function(){return this.size_},e.prototype.push_front=function(t){this.insert(this.begin_,t)},e.prototype.push_back=function(t){this.insert(this.end_,t)},e.prototype.pop_front=function(){if(!0===this.empty())throw f.ErrorGenerator.empty(this.end_.source().constructor.name,"pop_front");this.erase(this.begin_)},e.prototype.pop_back=function(){if(!0===this.empty())throw f.ErrorGenerator.empty(this.end_.source().constructor.name,"pop_back");this.erase(this.end_.prev())},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)return this.size();var n=new u.NativeArrayIterator(t,0),r=new u.NativeArrayIterator(t,t.length);return this._Insert_by_range(this.end(),n,r),this.size()},e.prototype.insert=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t.source()!==this.end_.source())throw f.ErrorGenerator.not_my_iterator(this.end_.source(),"insert");if(!0===t.erased_)throw f.ErrorGenerator.erased_iterator(this.end_.source(),"insert");return 1===e.length?this._Insert_by_repeating_val(t,1,e[0]):2===e.length&&"number"==typeof e[0]?this._Insert_by_repeating_val(t,e[0],e[1]):this._Insert_by_range(t,e[0],e[1])},e.prototype._Insert_by_repeating_val=function(t,e,n){var r=new c.Repeater(0,n),o=new c.Repeater(e);return this._Insert_by_range(t,r,o)},e.prototype._Insert_by_range=function(t,e,n){for(var r=t.prev(),o=null,i=0,s=e;!1===s.equals(n);s=s.next()){var c=this._Create_iterator(r,null,s.value);0===i&&(o=c),a.ListIterator._Set_next(r,c),r=c,++i}return!0===t.equals(this.begin())&&(this.begin_=o),a.ListIterator._Set_next(r,t),a.ListIterator._Set_prev(t,r),this.size_+=i,o},e.prototype.erase=function(t,e){return void 0===e&&(e=t.next()),this._Erase_by_range(t,e)},e.prototype._Erase_by_range=function(t,e){if(t.source()!==this.end_.source())throw f.ErrorGenerator.not_my_iterator(this.end_.source(),"insert");if(!0===t.erased_)throw f.ErrorGenerator.erased_iterator(this.end_.source(),"insert");if(t.equals(this.end_))return this.end_;var n=t.prev();a.ListIterator._Set_next(n,e),a.ListIterator._Set_prev(e,n);for(var r=t;!r.equals(e);r=r.next())r.erased_=!0,--this.size_;return t.equals(this.begin_)&&(this.begin_=e),e},e.prototype.swap=function(t){var e,n,r;e=i([t.begin_,this.begin_],2),this.begin_=e[0],t.begin_=e[1],n=i([t.end_,this.end_],2),this.end_=n[0],t.end_=n[1],r=i([t.size_,this.size_],2),this.size_=r[0],t.size_=r[1]},e}(s.Container);e.ListContainer=h},1566:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorGenerator=void 0;var r=n(9014),o=n(7632);!function(t){function e(t){if("string"==typeof t)return t;var e=t.constructor.name;return t.constructor.__MODULE&&(e="".concat(t.constructor.__MODULE,".").concat(e)),"std.".concat(e)}t.get_class_name=e,t.empty=function(t,n){return new o.OutOfRange("Error on ".concat(e(t),".").concat(n,"(): it's empty container."))},t.negative_index=function(t,n,r){return new o.OutOfRange("Error on ".concat(e(t),".").concat(n,"(): parametric index is negative -> (index = ").concat(r,")."))},t.excessive_index=function(t,n,r,i){return new o.OutOfRange("Error on ".concat(e(t),".").concat(n,"(): parametric index is equal or greater than size -> (index = ").concat(r,", size: ").concat(i,")."))},t.not_my_iterator=function(t,n){return new r.InvalidArgument("Error on ".concat(e(t),".").concat(n,"(): parametric iterator is not this container's own."))},t.erased_iterator=function(t,n){return new r.InvalidArgument("Error on ".concat(e(t),".").concat(n,"(): parametric iterator, it already has been erased."))},t.negative_iterator=function(t,n,r){return new o.OutOfRange("Error on ".concat(e(t),".").concat(n,"(): parametric iterator is directing negative position -> (index = ").concat(r,")."))},t.iterator_end_value=function(t,n){void 0===n&&(n="end");var r=e(t);return new o.OutOfRange("Error on ".concat(r,".Iterator.value: cannot access to the ").concat(r,".").concat(n,"().value."))},t.key_nout_found=function(t,n,r){throw new o.OutOfRange("Error on ".concat(e(t),".").concat(n,"(): unable to find the matched key -> ").concat(r))}}(e.ErrorGenerator||(e.ErrorGenerator={}))},1663:function(t,e){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.HashBuckets=void 0;var r=function(){function t(t,e){this.fetcher_=t,this.hasher_=e,this.max_load_factor_=i,this.data_=[],this.size_=0,this.initialize()}return t.prototype.clear=function(){this.data_=[],this.size_=0,this.initialize()},t.prototype.rehash=function(t){var e,r,i,s;t=Math.max(t,o);for(var a=[],c=0;c<t;++c)a.push([]);try{for(var u=n(this.data_),l=u.next();!l.done;l=u.next()){var f=l.value;try{for(var h=(i=void 0,n(f)),d=h.next();!d.done;d=h.next()){var p=d.value;a[this.hasher_(this.fetcher_(p))%a.length].push(p)}}catch(t){i={error:t}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}this.data_=a},t.prototype.reserve=function(t){t>this.capacity()&&(t=Math.floor(t/this.max_load_factor_),this.rehash(t))},t.prototype.initialize=function(){for(var t=0;t<o;++t)this.data_.push([])},t.prototype.length=function(){return this.data_.length},t.prototype.capacity=function(){return this.data_.length*this.max_load_factor_},t.prototype.at=function(t){return this.data_[t]},t.prototype.load_factor=function(){return this.size_/this.length()},t.prototype.max_load_factor=function(t){if(void 0===t&&(t=null),null===t)return this.max_load_factor_;this.max_load_factor_=t},t.prototype.hash_function=function(){return this.hasher_},t.prototype.index=function(t){return this.hasher_(this.fetcher_(t))%this.length()},t.prototype.insert=function(t){var e=this.capacity();++this.size_>e&&this.reserve(2*e);var n=this.index(t);this.data_[n].push(t)},t.prototype.erase=function(t){for(var e=this.index(t),n=this.data_[e],r=0;r<n.length;++r)if(n[r]===t){n.splice(r,1),--this.size_;break}},t}();e.HashBuckets=r;var o=10,i=1},3136:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.MapHashBuckets=void 0;var a=function(t){function e(e,n,r){var o=t.call(this,c,n)||this;return o.source_=e,o.key_eq_=r,o}return o(e,t),e._Swap_source=function(t,e){var n;n=i([e.source_,t.source_],2),t.source_=n[0],e.source_=n[1]},e.prototype.key_eq=function(){return this.key_eq_},e.prototype.find=function(t){var e,n,r=this.hash_function()(t)%this.length(),o=this.at(r);try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var c=a.value;if(this.key_eq_(c.first,t))return c}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return this.source_.end()},e}(n(1663).HashBuckets);function c(t){return t.first}e.MapHashBuckets=a},6449:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.SetHashBuckets=void 0;var a=function(t){function e(e,n,r){var o=t.call(this,c,n)||this;return o.source_=e,o.key_eq_=r,o}return o(e,t),e._Swap_source=function(t,e){var n;n=i([e.source_,t.source_],2),t.source_=n[0],e.source_=n[1]},e.prototype.key_eq=function(){return this.key_eq_},e.prototype.find=function(t){var e,n,r=this.hash_function()(t)%this.length(),o=this.at(r);try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var c=a.value;if(this.key_eq_(c.value,t))return c}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return this.source_.end()},e}(n(1663).HashBuckets);function c(t){return t.value}e.SetHashBuckets=a},2918:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ListIterator=void 0;var r=n(1566),o=function(){function t(t,e,n){this.prev_=t,this.next_=e,this.value_=n}return t._Set_prev=function(t,e){t.prev_=e},t._Set_next=function(t,e){t.next_=e},t.prototype.prev=function(){return this.prev_},t.prototype.next=function(){return this.next_},Object.defineProperty(t.prototype,"value",{get:function(){return this._Try_value(),this.value_},enumerable:!1,configurable:!0}),t.prototype._Try_value=function(){if(void 0===this.value_&&!0===this.equals(this.source().end()))throw r.ErrorGenerator.iterator_end_value(this.source())},t.prototype.equals=function(t){return this===t},t}();e.ListIterator=o},5709:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReverseIterator=void 0;var n=function(){function t(t){this.base_=t.prev()}return t.prototype.source=function(){return this.base_.source()},t.prototype.base=function(){return this.base_.next()},Object.defineProperty(t.prototype,"value",{get:function(){return this.base_.value},enumerable:!1,configurable:!0}),t.prototype.prev=function(){return this._Create_neighbor(this.base().next())},t.prototype.next=function(){return this._Create_neighbor(this.base_)},t.prototype.equals=function(t){return this.base_.equals(t.base_)},t}();e.ReverseIterator=n},7428:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ForOfAdaptor=void 0;var n=function(){function t(t,e){this.it_=t,this.last_=e}return t.prototype.next=function(){if(this.it_.equals(this.last_))return{done:!0,value:void 0};var t=this.it_;return this.it_=this.it_.next(),{done:!1,value:t.value}},t.prototype[Symbol.iterator]=function(){return this},t}();e.ForOfAdaptor=n},9932:function(t,e){"use strict";var n=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.NativeArrayIterator=void 0;var r=function(){function t(t,e){this.data_=t,this.index_=e}return t.prototype.index=function(){return this.index_},Object.defineProperty(t.prototype,"value",{get:function(){return this.data_[this.index_]},enumerable:!1,configurable:!0}),t.prototype.prev=function(){return--this.index_,this},t.prototype.next=function(){return++this.index_,this},t.prototype.advance=function(t){return this.index_+=t,this},t.prototype.equals=function(t){return this.data_===t.data_&&this.index_===t.index_},t.prototype.swap=function(t){var e,r;e=n([t.data_,this.data_],2),this.data_=e[0],t.data_=e[1],r=n([t.index_,this.index_],2),this.index_=r[0],t.index_=r[1]},t}();e.NativeArrayIterator=r},7489:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Repeater=void 0;var n=function(){function t(t,e){this.index_=t,this.value_=e}return t.prototype.index=function(){return this.index_},Object.defineProperty(t.prototype,"value",{get:function(){return this.value_},enumerable:!1,configurable:!0}),t.prototype.next=function(){return++this.index_,this},t.prototype.equals=function(t){return this.index_===t.index_},t}();e.Repeater=n},6937:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.next=e.prev=e.advance=e.distance=e.size=e.empty=void 0;var r=n(9014);function o(t,e){if(0===e)return t;if(t.advance instanceof Function)return t.advance(e);var n;if(e<0){if(!(t.prev instanceof Function))throw new r.InvalidArgument("Error on std.advance(): parametric iterator is not a bi-directional iterator, thus advancing to negative direction is not possible.");n=function(t){return t.prev()},e=-e}else n=function(t){return t.next()};for(;e-- >0;)t=n(t);return t}e.empty=function(t){return t instanceof Array?0!==t.length:t.empty()},e.size=function(t){return t instanceof Array?t.length:t.size()},e.distance=function(t,e){if(t.index instanceof Function)return function(t,e){var n=t.index(),r=e.index();return t.base instanceof Function?n-r:r-n}(t,e);for(var n=0;!t.equals(e);t=t.next())++n;return n},e.advance=o,e.prev=function(t,e){return void 0===e&&(e=1),1===e?t.prev():o(t,-e)},e.next=function(t,e){return void 0===e&&(e=1),1===e?t.next():o(t,e)}},9430:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Entry=void 0;var r=n(9029),o=n(8925),i=function(){function t(t,e){this.first=t,this.second=e}return t.prototype.equals=function(t){return(0,o.equal_to)(this.first,t.first)},t.prototype.less=function(t){return(0,o.less)(this.first,t.first)},t.prototype.hashCode=function(){return(0,r.hash)(this.first)},t}();e.Entry=i},5351:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.make_pair=e.Pair=void 0;var r=n(9029),o=n(8925),i=function(){function t(t,e){this.first=t,this.second=e}return t.prototype.equals=function(t){return(0,o.equal_to)(this.first,t.first)&&(0,o.equal_to)(this.second,t.second)},t.prototype.less=function(t){return!1===(0,o.equal_to)(this.first,t.first)?(0,o.less)(this.first,t.first):(0,o.less)(this.second,t.second)},t.prototype.hashCode=function(){return(0,r.hash)(this.first,this.second)},t}();e.Pair=i,e.make_pair=function(t,e){return new i(t,e)}},4922:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.is_node=void 0;var r=null;e.is_node=function(){return null===r&&(r="object"==typeof n.g&&"object"==typeof n.g.process&&"object"==typeof n.g.process.versions&&void 0!==n.g.process.versions.node),r}},5995:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(5840),a=n(1112),c=n(9653),u=n(4164),l=n(4584),f=n(5025),h=function(t){function e(n,r){var o=t.call(this)||this;return o.on_={},o.state_=e.CONNECTING,o.client_=new s.client,o.client_.on("connect",o._Handle_connect.bind(o)),o.client_.on("connectFailed",o._Handle_error.bind(o)),"string"==typeof r&&(r=[r]),o.client_.connect(n,r),o}return o(e,t),e.prototype.close=function(t,n){this.state_=e.CLOSING,void 0===t?this.connection_.sendCloseFrame():this.connection_.sendCloseFrame(t,n,!0)},e.prototype.send=function(t){if("string"==typeof t.valueOf())this.connection_.sendUTF(t);else{var e;e=t instanceof Buffer?t:t instanceof Blob?new Buffer(t,"blob"):t.buffer?new Buffer(t.buffer):new Buffer(t),this.connection_.sendBytes(e)}},Object.defineProperty(e.prototype,"url",{get:function(){return this.client_.url.href},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this.client_.protocols?this.client_.protocols[0]:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this.connection_&&this.connection_.extensions?this.connection_.extensions[0].name:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.state_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this.connection_.bytesWaitingToFlush},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return"arraybuffer"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onopen",{get:function(){return this.on_.open},set:function(t){this._Set_on("open",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onclose",{get:function(){return this.on_.close},set:function(t){this._Set_on("close",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onmessage",{get:function(){return this.on_.message},set:function(t){this._Set_on("message",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this.on_.error},set:function(t){this._Set_on("error",t)},enumerable:!0,configurable:!0}),e.prototype._Set_on=function(t,e){this.on_[t]&&this.removeEventListener(t,this.on_[t]),this.addEventListener(t,e),this.on_[t]=e},e.prototype._Handle_connect=function(t){this.connection_=t,this.state_=e.OPEN,this.connection_.on("message",this._Handle_message.bind(this)),this.connection_.on("error",this._Handle_error.bind(this)),this.connection_.on("close",this._Handle_close.bind(this));var n=new c.Event("open",d);this.dispatchEvent(n)},e.prototype._Handle_close=function(t,n){var r=new u.CloseEvent("close",i({},d,{code:t,reason:n}));this.state_=e.CLOSED,this.dispatchEvent(r)},e.prototype._Handle_message=function(t){var e=new l.MessageEvent("message",i({},d,{data:t.binaryData?t.binaryData:t.utf8Data}));this.dispatchEvent(e)},e.prototype._Handle_error=function(t){var n=new f.ErrorEvent("error",i({},d,{error:t,message:t.message}));this.state_===e.CONNECTING&&(this.state_=e.CLOSED),this.dispatchEvent(n)},e}(a.EventTarget);e.WebSocket=h,function(t){t.CONNECTING=0,t.OPEN=1,t.CLOSING=2,t.CLOSED=3}(h=e.WebSocket||(e.WebSocket={})),e.WebSocket=h;var d={bubbles:!1,cancelable:!1}},4164:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e}(n(9653).Event);e.CloseEvent=i},5025:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e}(n(9653).Event);e.ErrorEvent=i},9653:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Event=function(t,e){this.type=t,e&&Object.assign(this,e)}},1112:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(5017),i=n(1266),s=function(){function t(){this.listeners_=new i.HashMap,this.created_at_=new Date}return t.prototype.dispatchEvent=function(t){var e,n,o=this.listeners_.find(t.type);if(!o.equals(this.listeners_.end())){t.target=this,t.timeStamp=(new Date).getTime()-this.created_at_.getTime();try{for(var i=r(o.second),s=i.next();!s.done;s=i.next())(0,s.value)(t)}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.addEventListener=function(t,e){var n=this.listeners_.find(t);n.equals(this.listeners_.end())&&(n=this.listeners_.emplace(t,new o.HashSet).first),n.second.insert(e)},t.prototype.removeEventListener=function(t,e){var n=this.listeners_.find(t);n.equals(this.listeners_.end())||(n.second.erase(e),n.second.empty()&&this.listeners_.erase(n))},t}();e.EventTarget=s},4584:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e}(n(9653).Event);e.MessageEvent=i},6445:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(4922).is_node()&&(n.g.WebSocket=n(5995).WebSocket)},5840:(t,e,n)=>{var r;if("object"==typeof globalThis)r=globalThis;else try{r=n(284)}catch(t){}finally{if(r||"undefined"==typeof window||(r=window),!r)throw new Error("Could not determine global this")}var o=r.WebSocket||r.MozWebSocket,i=n(9387);function s(t,e){return e?new o(t,e):new o(t)}o&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(t){Object.defineProperty(s,t,{get:function(){return o[t]}})})),t.exports={w3cwebsocket:o?s:null,version:i}},9387:(t,e,n)=>{t.exports=n(9794).version},9381:(t,e,n)=>{"use strict";var r,o=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,c=(t,e)=>{for(var n in e)o(t,n,{get:e[n],enumerable:!0})},u={};c(u,{AbstractRelay:()=>_e,AbstractSimplePool:()=>Ee,Relay:()=>me,SimplePool:()=>xe,Subscription:()=>we,finalizeEvent:()=>I,fj:()=>ae,generateSecretKey:()=>k,getEventHash:()=>S,getFilterLimit:()=>se,getPublicKey:()=>T,kinds:()=>C,matchFilter:()=>re,matchFilters:()=>oe,mergeFilters:()=>ie,nip04:()=>Fe,nip05:()=>Je,nip10:()=>nn,nip11:()=>on,nip13:()=>cn,nip18:()=>fn,nip19:()=>Oe,nip21:()=>yn,nip25:()=>wn,nip27:()=>En,nip28:()=>Sn,nip30:()=>Cn,nip39:()=>qn,nip42:()=>pe,nip44:()=>$n,nip47:()=>tr,nip57:()=>rr,nip98:()=>fr,parseReferences:()=>De,relayConnect:()=>ve,serializeEvent:()=>B,utils:()=>b,validateEvent:()=>p,verifiedSymbol:()=>h,verifyEvent:()=>L}),t.exports=(r=u,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||o(t,n,{get:()=>e[n],enumerable:!(r=i(e,n))||r.enumerable});return t})(o({},"__esModule",{value:!0}),r));var l=n(3497),f=n(8089),h=Symbol("verified"),d=t=>t instanceof Object;function p(t){if(!d(t))return!1;if("number"!=typeof t.kind)return!1;if("string"!=typeof t.content)return!1;if("number"!=typeof t.created_at)return!1;if("string"!=typeof t.pubkey)return!1;if(!t.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let t=0;t<n.length;t++)if("object"==typeof n[t])return!1}return!0}var y=n(3061),b={};c(b,{Queue:()=>O,QueueNode:()=>x,binarySearch:()=>E,insertEventIntoAscendingList:()=>m,insertEventIntoDescendingList:()=>v,normalizeURL:()=>w,utf8Decoder:()=>g,utf8Encoder:()=>_});var g=new TextDecoder("utf-8"),_=new TextEncoder;function w(t){let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}function v(t,e){const[n,r]=E(t,(t=>e.id===t.id?0:e.created_at===t.created_at?-1:t.created_at-e.created_at));return r||t.splice(n,0,e),t}function m(t,e){const[n,r]=E(t,(t=>e.id===t.id?0:e.created_at===t.created_at?-1:e.created_at-t.created_at));return r||t.splice(n,0,e),t}function E(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),i=e(t[o]);if(0===i)return[o,!0];i<0?r=o-1:n=o+1}return[n,!1]}var x=class{value;next=null;prev=null;constructor(t){this.value=t}},O=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new x(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const t=this.first;return this.first=t.next,t.value}};function B(t){if(!p(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function S(t){let e=(0,y.sha256)(_.encode(B(t)));return(0,f.bytesToHex)(e)}var A=new class{generateSecretKey(){return l.schnorr.utils.randomPrivateKey()}getPublicKey(t){return(0,f.bytesToHex)(l.schnorr.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=(0,f.bytesToHex)(l.schnorr.getPublicKey(e)),n.id=S(n),n.sig=(0,f.bytesToHex)(l.schnorr.sign(S(n),e)),n[h]=!0,n}verifyEvent(t){if("boolean"==typeof t[h])return t[h];const e=S(t);if(e!==t.id)return t[h]=!1,!1;try{const n=l.schnorr.verify(t.sig,e,t.pubkey);return t[h]=n,n}catch(e){return t[h]=!1,!1}}},k=A.generateSecretKey,T=A.getPublicKey,I=A.finalizeEvent,L=A.verifyEvent,C={};function P(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function j(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function U(t){return 2e4<=t&&t<3e4}function H(t){return 3e4<=t&&t<4e4}function R(t){return P(t)?"regular":j(t)?"replaceable":U(t)?"ephemeral":H(t)?"parameterized":"unknown"}c(C,{Application:()=>Vt,BadgeAward:()=>K,BadgeDefinition:()=>qt,BlockedRelaysList:()=>mt,BookmarkList:()=>_t,Bookmarksets:()=>Ut,Calendar:()=>Xt,CalendarEventRSVP:()=>Qt,ChannelCreation:()=>Z,ChannelHideMessage:()=>X,ChannelMessage:()=>Y,ChannelMetadata:()=>J,ChannelMuteUser:()=>Q,ClassifiedListing:()=>Gt,ClientAuth:()=>At,CommunitiesList:()=>wt,CommunityDefinition:()=>ne,CommunityPostApproval:()=>at,Contacts:()=>$,CreateOrUpdateProduct:()=>$t,CreateOrUpdateStall:()=>Mt,Curationsets:()=>Ht,Date:()=>Jt,DraftClassifiedListing:()=>Zt,DraftLong:()=>Ft,Emojisets:()=>zt,EncryptedDirectMessage:()=>D,EncryptedDirectMessages:()=>F,EventDeletion:()=>z,FileMetadata:()=>et,Followsets:()=>Ct,GenericRepost:()=>G,Genericlists:()=>Pt,HTTPAuth:()=>Lt,Handlerinformation:()=>ee,Handlerrecommendation:()=>te,Highlights:()=>pt,InterestsList:()=>xt,Interestsets:()=>Nt,JobFeedback:()=>lt,JobRequest:()=>ct,JobResult:()=>ut,Label:()=>st,LightningPubRPC:()=>St,LiveChatMessage:()=>nt,LiveEvent:()=>Wt,LongFormArticle:()=>Dt,Metadata:()=>q,Mutelist:()=>yt,NWCWalletInfo:()=>Bt,NWCWalletRequest:()=>kt,NWCWalletResponse:()=>Tt,NostrConnect:()=>It,OpenTimestamps:()=>tt,Pinlist:()=>bt,ProblemTracker:()=>rt,ProfileBadges:()=>Rt,PublicChatsList:()=>vt,Reaction:()=>W,RecommendRelay:()=>M,RelayList:()=>gt,Relaysets:()=>jt,Report:()=>ot,Reporting:()=>it,Repost:()=>V,SearchRelaysList:()=>Et,ShortTextNote:()=>N,Time:()=>Yt,UserEmojiList:()=>Ot,UserStatuses:()=>Kt,Zap:()=>dt,ZapGoal:()=>ft,ZapRequest:()=>ht,classifyKind:()=>R,isEphemeralKind:()=>U,isParameterizedReplaceableKind:()=>H,isRegularKind:()=>P,isReplaceableKind:()=>j});var q=0,N=1,M=2,$=3,D=4,F=4,z=5,V=6,W=7,K=8,G=16,Z=40,J=41,Y=42,X=43,Q=44,tt=1040,et=1063,nt=1311,rt=1971,ot=1984,it=1984,st=1985,at=4550,ct=5999,ut=6999,lt=7e3,ft=9041,ht=9734,dt=9735,pt=9802,yt=1e4,bt=10001,gt=10002,_t=10003,wt=10004,vt=10005,mt=10006,Et=10007,xt=10015,Ot=10030,Bt=13194,St=21e3,At=22242,kt=23194,Tt=23195,It=24133,Lt=27235,Ct=3e4,Pt=30001,jt=30002,Ut=30003,Ht=30004,Rt=30008,qt=30009,Nt=30015,Mt=30017,$t=30018,Dt=30023,Ft=30024,zt=30030,Vt=30078,Wt=30311,Kt=30315,Gt=30402,Zt=30403,Jt=31922,Yt=31923,Xt=31924,Qt=31925,te=31989,ee=31990,ne=34550;function re(t,e){if(t.ids&&-1===t.ids.indexOf(e.id)&&!t.ids.some((t=>e.id.startsWith(t))))return!1;if(t.kinds&&-1===t.kinds.indexOf(e.kind))return!1;if(t.authors&&-1===t.authors.indexOf(e.pubkey)&&!t.authors.some((t=>e.pubkey.startsWith(t))))return!1;for(let n in t)if("#"===n[0]){let r=t[`#${n.slice(1)}`];if(r&&!e.tags.find((([t,e])=>t===n.slice(1)&&-1!==r.indexOf(e))))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}function oe(t,e){for(let n=0;n<t.length;n++)if(re(t[n],e))return!0;return!1}function ie(...t){let e={};for(let n=0;n<t.length;n++){let r=t[n];Object.entries(r).forEach((([t,n])=>{if("kinds"===t||"ids"===t||"authors"===t||"#"===t[0]){e[t]=e[t]||[];for(let r=0;r<n.length;r++){let o=n[r];e[t].includes(o)||e[t].push(o)}}})),r.limit&&(!e.limit||r.limit>e.limit)&&(e.limit=r.limit),r.until&&(!e.until||r.until>e.until)&&(e.until=r.until),r.since&&(!e.since||r.since<e.since)&&(e.since=r.since)}return e}function se(t){return t.ids&&!t.ids.length||t.kinds&&!t.kinds.length||t.authors&&!t.authors.length?0:Math.min(Math.max(0,t.limit??1/0),t.ids?.length??1/0,t.authors?.length&&t.kinds?.every((t=>j(t)))?t.authors.length*t.kinds.length:1/0)}var ae={};function ce(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function ue(t,e){let n=e.length,r=t.indexOf(`"${e}":`)+n+3,o=t.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function le(t){let e=t.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let n=t.slice(e+7+1).indexOf('"');if(-1===n)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return t.slice(r+1,i)}function fe(t,e){return e===ce(t,"id")}function he(t,e){return e===ce(t,"pubkey")}function de(t,e){return e===ue(t,"kind")}c(ae,{getHex64:()=>ce,getInt:()=>ue,getSubscriptionId:()=>le,matchEventId:()=>fe,matchEventKind:()=>de,matchEventPubkey:()=>he});var pe={};function ye(t,e){return{kind:At,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}async function be(){return new Promise((t=>{const e=new MessageChannel,n=()=>{e.port1.removeEventListener("message",n),t()};e.port1.addEventListener("message",n),e.port2.postMessage(0),e.port1.start()}))}c(pe,{makeAuthEvent:()=>ye});var ge=t=>(t[h]=!0,!0),_e=class{url;_connected=!1;onclose=null;onnotice=t=>console.debug(`NOTICE from ${this.url}: ${t}`);baseEoseTimeout=4400;connectionTimeout=4400;openSubs=new Map;connectionTimeoutHandle;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new O;queueRunning=!1;challenge;serial=0;verifyEvent;constructor(t,e){this.url=w(t),this.verifyEvent=e.verifyEvent}static async connect(t,e){const n=new _e(t,e);return await n.connect(),n}closeAllSubscriptions(t){for(let[e,n]of this.openSubs)n.close(t);this.openSubs.clear();for(let[e,n]of this.openEventPublishes)n.reject(new Error(t));this.openEventPublishes.clear();for(let[e,n]of this.openCountRequests)n.reject(new Error(t));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise||(this.challenge=void 0,this.connectionPromise=new Promise(((t,e)=>{this.connectionTimeoutHandle=setTimeout((()=>{e("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")}),this.connectionTimeout);try{this.ws=new WebSocket(this.url)}catch(t){return void e(t)}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,t()},this.ws.onerror=t=>{e(t.message),this._connected&&(this.onclose?.(),this.closeAllSubscriptions("relay connection errored"),this._connected=!1)},this.ws.onclose=async()=>{this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection closed"),this._connected=!1},this.ws.onmessage=this._onmessage.bind(this)}))),this.connectionPromise}async runQueue(){for(this.queueRunning=!0;!1!==this.handleNext();)await be();this.queueRunning=!1}handleNext(){const t=this.incomingMessageQueue.dequeue();if(!t)return!1;const e=le(t);if(e){const n=this.openSubs.get(e);if(!n)return;const r=ce(t,"id"),o=n.alreadyHaveEvent?.(r);if(n.receivedEvent?.(this,r),o)return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":{const t=this.openSubs.get(e[1]),n=e[2];return void(this.verifyEvent(n)&&oe(t.filters,n)&&t.onevent(n))}case"COUNT":{const t=e[1],n=e[2],r=this.openCountRequests.get(t);return void(r&&(r.resolve(n.count),this.openCountRequests.delete(t)))}case"EOSE":{const t=this.openSubs.get(e[1]);if(!t)return;return void t.receivedEose()}case"OK":{const t=e[1],n=e[2],r=e[3],o=this.openEventPublishes.get(t);return n?o.resolve(r):o.reject(new Error(r)),void this.openEventPublishes.delete(t)}case"CLOSED":{const t=e[1],n=this.openSubs.get(t);if(!n)return;return n.closed=!0,void n.close(e[2])}case"NOTICE":return void this.onnotice(e[1]);case"AUTH":return void(this.challenge=e[1])}}catch(t){return}}async send(t){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then((()=>{this.ws?.send(t)}))}async auth(t){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");const e=await t(ye(this.url,this.challenge)),n=new Promise(((t,n)=>{this.openEventPublishes.set(e.id,{resolve:t,reject:n})}));return this.send('["AUTH",'+JSON.stringify(e)+"]"),n}async publish(t){const e=new Promise(((e,n)=>{this.openEventPublishes.set(t.id,{resolve:e,reject:n})}));return this.send('["EVENT",'+JSON.stringify(t)+"]"),e}async count(t,e){this.serial++;const n=e?.id||"count:"+this.serial,r=new Promise(((t,e)=>{this.openCountRequests.set(n,{resolve:t,reject:e})}));return this.send('["COUNT","'+n+'",'+JSON.stringify(t)+"]"),r}subscribe(t,e){const n=this.prepareSubscription(t,e);return n.fire(),n}prepareSubscription(t,e){this.serial++;const n=e.id||"sub:"+this.serial,r=new we(this,n,t,e);return this.openSubs.set(n,r),r}close(){this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.ws?.close()}_onmessage(t){this.incomingMessageQueue.enqueue(t.data),this.queueRunning||this.runQueue()}},we=class{relay;id;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;eoseTimeout;eoseTimeoutHandle;constructor(t,e,n,r){this.relay=t,this.filters=n,this.id=e,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||t.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(t=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,t)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(t="closed by caller"){this.closed||(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),this.onclose?.(t)}};function ve(t){return me.connect(t)}var me=class extends _e{constructor(t){super(t,{verifyEvent:L})}static async connect(t){const e=new me(t);return await e.connect(),e}},Ee=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;trustedRelayURLs=new Set;constructor(t){this.verifyEvent=t.verifyEvent}async ensureRelay(t,e){t=w(t);let n=this.relays.get(t);return n||(n=new _e(t,{verifyEvent:this.trustedRelayURLs.has(t)?ge:this.verifyEvent}),e?.connectionTimeout&&(n.connectionTimeout=e.connectionTimeout),this.relays.set(t,n)),await n.connect(),n}close(t){t.map(w).forEach((t=>{this.relays.get(t)?.close()}))}subscribeMany(t,e,n){this.trackRelays&&(n.receivedEvent=(t,e)=>{let n=this.seenOn.get(e);n||(n=new Set,this.seenOn.set(e,n)),n.add(t)});const r=new Set,o=[],i=[];let s=e=>{i[e]=!0,i.filter((t=>t)).length===t.length&&(n.oneose?.(),s=()=>{})};const a=[];let c=(e,r)=>{s(e),a[e]=r,a.filter((t=>t)).length===t.length&&(n.onclose?.(a),c=()=>{})};const u=t=>{if(n.alreadyHaveEvent?.(t))return!0;const e=r.has(t);return r.add(t),e},l=Promise.all(t.map(w).map((async(t,r,i)=>{if(i.indexOf(t)!==r)return void c(r,"duplicate url");let a;try{a=await this.ensureRelay(t,{connectionTimeout:n.maxWait?Math.max(.8*n.maxWait,n.maxWait-1e3):void 0})}catch(t){return void c(r,t?.message||String(t))}let l=a.subscribe(e,{...n,oneose:()=>s(r),onclose:t=>c(r,t),alreadyHaveEvent:u,eoseTimeout:n.maxWait});o.push(l)})));return{async close(){await l,o.forEach((t=>{t.close()}))}}}subscribeManyEose(t,e,n){const r=this.subscribeMany(t,e,{...n,oneose(){r.close()}});return r}async querySync(t,e,n){return new Promise((async r=>{const o=[];this.subscribeManyEose(t,[e],{...n,onevent(t){o.push(t)},onclose(t){r(o)}})}))}async get(t,e,n){e.limit=1;const r=await this.querySync(t,e,n);return r.sort(((t,e)=>e.created_at-t.created_at)),r[0]||null}publish(t,e){return t.map(w).map((async(t,n,r)=>r.indexOf(t)!==n?Promise.reject("duplicate url"):(await this.ensureRelay(t)).publish(e)))}},xe=class extends Ee{constructor(){super({verifyEvent:L})}},Oe={};c(Oe,{BECH32_REGEX:()=>ke,decode:()=>Te,naddrEncode:()=>qe,neventEncode:()=>Re,noteEncode:()=>Pe,nprofileEncode:()=>He,npubEncode:()=>Ce,nrelayEncode:()=>Ne,nsecEncode:()=>Le});var Be=n(8089),Se=n(9187),Ae=5e3,ke=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Te(t){let{prefix:e,words:n}=Se.bech32.decode(t,Ae),r=new Uint8Array(Se.bech32.fromWords(n));switch(e){case"nprofile":{let t=Ie(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:(0,Be.bytesToHex)(t[0][0]),relays:t[1]?t[1].map((t=>g.decode(t))):[]}}}case"nevent":{let t=Ie(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(t[2]&&32!==t[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(t[3]&&4!==t[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:(0,Be.bytesToHex)(t[0][0]),relays:t[1]?t[1].map((t=>g.decode(t))):[],author:t[2]?.[0]?(0,Be.bytesToHex)(t[2][0]):void 0,kind:t[3]?.[0]?parseInt((0,Be.bytesToHex)(t[3][0]),16):void 0}}}case"naddr":{let t=Ie(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!t[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==t[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!t[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==t[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:g.decode(t[0][0]),pubkey:(0,Be.bytesToHex)(t[2][0]),kind:parseInt((0,Be.bytesToHex)(t[3][0]),16),relays:t[1]?t[1].map((t=>g.decode(t))):[]}}}case"nrelay":{let t=Ie(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:g.decode(t[0][0])}}case"nsec":return{type:e,data:r};case"npub":case"note":return{type:e,data:(0,Be.bytesToHex)(r)};default:throw new Error(`unknown prefix ${e}`)}}function Ie(t){let e={},n=t;for(;n.length>0;){let t=n[0],r=n[1],o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${t}`);e[t]=e[t]||[],e[t].push(o)}return e}function Le(t){return Ue("nsec",t)}function Ce(t){return Ue("npub",(0,Be.hexToBytes)(t))}function Pe(t){return Ue("note",(0,Be.hexToBytes)(t))}function je(t,e){let n=Se.bech32.toWords(e);return Se.bech32.encode(t,n,Ae)}function Ue(t,e){return je(t,e)}function He(t){return je("nprofile",Me({0:[(0,Be.hexToBytes)(t.pubkey)],1:(t.relays||[]).map((t=>_.encode(t)))}))}function Re(t){let e;return void 0!==t.kind&&(e=function(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=255&t,e}(t.kind)),je("nevent",Me({0:[(0,Be.hexToBytes)(t.id)],1:(t.relays||[]).map((t=>_.encode(t))),2:t.author?[(0,Be.hexToBytes)(t.author)]:[],3:e?[new Uint8Array(e)]:[]}))}function qe(t){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,t.kind,!1),je("naddr",Me({0:[_.encode(t.identifier)],1:(t.relays||[]).map((t=>_.encode(t))),2:[(0,Be.hexToBytes)(t.pubkey)],3:[new Uint8Array(e)]}))}function Ne(t){return je("nrelay",Me({0:[_.encode(t)]}))}function Me(t){let e=[];return Object.entries(t).reverse().forEach((([t,n])=>{n.forEach((n=>{let r=new Uint8Array(n.length+2);r.set([parseInt(t)],0),r.set([n.length],1),r.set(n,2),e.push(r)}))})),(0,Be.concatBytes)(...e)}var $e=/\bnostr:((note|npub|naddr|nevent|nprofile)1\w+)\b|#\[(\d+)\]/g;function De(t){let e=[];for(let n of t.content.matchAll($e))if(n[2])try{let{type:t,data:r}=Te(n[1]);switch(t){case"npub":e.push({text:n[0],profile:{pubkey:r,relays:[]}});break;case"nprofile":e.push({text:n[0],profile:r});break;case"note":e.push({text:n[0],event:{id:r,relays:[]}});break;case"nevent":e.push({text:n[0],event:r});break;case"naddr":e.push({text:n[0],address:r})}}catch(t){}else if(n[3]){let r=parseInt(n[3],10),o=t.tags[r];if(!o)continue;switch(o[0]){case"p":e.push({text:n[0],profile:{pubkey:o[1],relays:o[2]?[o[2]]:[]}});break;case"e":e.push({text:n[0],event:{id:o[1],relays:o[2]?[o[2]]:[]}});break;case"a":try{let[t,r,i]=o[1].split(":");e.push({text:n[0],address:{identifier:i,pubkey:r,kind:parseInt(t,10),relays:o[2]?[o[2]]:[]}})}catch(t){}}}return e}var Fe={};c(Fe,{decrypt:()=>Ge,encrypt:()=>Ke});var ze=n(8089),Ve=n(3497),We=n(9187);async function Ke(t,e,n){const r=t instanceof Uint8Array?(0,ze.bytesToHex)(t):t,o=Ze(Ve.secp256k1.getSharedSecret(r,"02"+e));let i=Uint8Array.from((0,ze.randomBytes)(16)),s=_.encode(n),a=await crypto.subtle.importKey("raw",o,{name:"AES-CBC"},!1,["encrypt"]),c=await crypto.subtle.encrypt({name:"AES-CBC",iv:i},a,s);return`${We.base64.encode(new Uint8Array(c))}?iv=${We.base64.encode(new Uint8Array(i.buffer))}`}async function Ge(t,e,n){const r=t instanceof Uint8Array?(0,ze.bytesToHex)(t):t;let[o,i]=n.split("?iv="),s=Ze(Ve.secp256k1.getSharedSecret(r,"02"+e)),a=await crypto.subtle.importKey("raw",s,{name:"AES-CBC"},!1,["decrypt"]),c=We.base64.decode(o),u=We.base64.decode(i),l=await crypto.subtle.decrypt({name:"AES-CBC",iv:u},a,c);return g.decode(l)}function Ze(t){return t.slice(1,33)}"undefined"!=typeof crypto&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle);var Je={};c(Je,{NIP05_REGEX:()=>Xe,queryProfile:()=>en,searchDomain:()=>tn,useFetchImplementation:()=>Qe});var Ye,Xe=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{Ye=fetch}catch{}function Qe(t){Ye=t}async function tn(t,e=""){try{return(await(await Ye(`https://${t}/.well-known/nostr.json?name=${e}`)).json()).names}catch(t){return{}}}async function en(t){const e=t.match(Xe);if(!e)return null;const[n,r="_",o]=e;try{const t=await Ye(`https://${o}/.well-known/nostr.json?name=${r}`),{names:e,relays:n}=function(t){const e={names:{}};for(const[n,r]of Object.entries(t.names))"string"==typeof n&&"string"==typeof r&&(e.names[n]=r);if(t.relays){e.relays={};for(const[n,r]of Object.entries(t.relays))"string"==typeof n&&Array.isArray(r)&&(e.relays[n]=r.filter((t=>"string"==typeof t)))}return e}(await t.json()),i=e[r];return i?{pubkey:i,relays:n?.[i]}:null}catch(t){return null}}var nn={};function rn(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[]},n=[];for(const r of t.tags)"e"===r[0]&&r[1]&&n.push(r),"p"===r[0]&&r[1]&&e.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let t=0;t<n.length;t++){const r=n[t],[o,i,s,a]=r,c={id:i,relays:s?[s]:[]},u=0===t,l=t===n.length-1;"root"!==a?"reply"!==a?"mention"!==a?u?e.root=c:l?e.reply=c:e.mentions.push(c):e.mentions.push(c):e.reply=c:e.root=c}return e}c(nn,{parse:()=>rn});var on={};c(on,{fetchRelayInformation:()=>an,useFetchImplementation:()=>sn});try{fetch}catch{}function sn(t){}async function an(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var cn={};function un(t){let e=0;for(let n=0;n<t.length;n++){const r=parseInt(t[n],16);if(0!==r){e+=Math.clz32(r)-28;break}e+=4}return e}function ln(t,e){let n=0;const r=t,o=["nonce",n.toString(),e.toString()];for(r.tags.push(o);;){const t=Math.floor((new Date).getTime()/1e3);if(t!==r.created_at&&(n=0,r.created_at=t),o[1]=(++n).toString(),r.id=S(r),un(r.id)>=e)break}return r}c(cn,{getPow:()=>un,minePow:()=>ln});var fn={};function hn(t,e,n,r){return I({kind:V,tags:[...t.tags??[],["e",e.id,n],["p",e.pubkey]],content:""===t.content?"":JSON.stringify(e),created_at:t.created_at},r)}function dn(t){if(t.kind!==V)return;let e,n;for(let r=t.tags.length-1;r>=0&&(void 0===e||void 0===n);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===e?e=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==e?{id:e[1],relays:[e[2],n?.[2]].filter((t=>"string"==typeof t)),author:n?.[1]}:void 0}function pn(t,{skipVerification:e}={}){const n=dn(t);if(void 0===n||""===t.content)return;let r;try{r=JSON.parse(t.content)}catch(t){return}return r.id===n.id&&(e||L(r))?r:void 0}c(fn,{finishRepostEvent:()=>hn,getRepostedEvent:()=>pn,getRepostedEventPointer:()=>dn});var yn={};c(yn,{NOSTR_URI_REGEX:()=>bn,parse:()=>_n,test:()=>gn});var bn=new RegExp(`nostr:(${ke.source})`);function gn(t){return"string"==typeof t&&new RegExp(`^${bn.source}$`).test(t)}function _n(t){const e=t.match(new RegExp(`^${bn.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:Te(e[1])}}var wn={};function vn(t,e,n){const r=e.tags.filter((t=>t.length>=2&&("e"===t[0]||"p"===t[0])));return I({...t,kind:W,tags:[...t.tags??[],...r,["e",e.id],["p",e.pubkey]],content:t.content??"+"},n)}function mn(t){if(t.kind!==W)return;let e,n;for(let r=t.tags.length-1;r>=0&&(void 0===e||void 0===n);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===e?e=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==e&&void 0!==n?{id:e[1],relays:[e[2],n[2]].filter((t=>void 0!==t)),author:n[1]}:void 0}c(wn,{finishReactionEvent:()=>vn,getReactedEventPointer:()=>mn});var En={};c(En,{matchAll:()=>On,regex:()=>xn,replaceAll:()=>Bn});var xn=()=>new RegExp(`\\b${bn.source}\\b`,"g");function*On(t){const e=t.matchAll(xn());for(const t of e)try{const[e,n]=t;yield{uri:e,value:n,decoded:Te(n),start:t.index,end:t.index+e.length}}catch(t){}}function Bn(t,e){return t.replaceAll(xn(),((t,n)=>e({uri:t,value:n,decoded:Te(n)})))}var Sn={};c(Sn,{channelCreateEvent:()=>An,channelHideMessageEvent:()=>In,channelMessageEvent:()=>Tn,channelMetadataEvent:()=>kn,channelMuteUserEvent:()=>Ln});var An=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return I({kind:Z,tags:[...t.tags??[]],content:n,created_at:t.created_at},e)},kn=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return I({kind:J,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Tn=(t,e)=>{const n=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&n.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),I({kind:Y,tags:[...n,...t.tags??[]],content:t.content,created_at:t.created_at},e)},In=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return I({kind:X,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Ln=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return I({kind:Q,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:n,created_at:t.created_at},e)},Cn={};c(Cn,{EMOJI_SHORTCODE_REGEX:()=>Pn,matchAll:()=>Un,regex:()=>jn,replaceAll:()=>Hn});var Pn=/:(\w+):/,jn=()=>new RegExp(`\\B${Pn.source}\\B`,"g");function*Un(t){const e=t.matchAll(jn());for(const t of e)try{const[e,n]=t;yield{shortcode:e,name:n,start:t.index,end:t.index+e.length}}catch(t){}}function Hn(t,e){return t.replaceAll(jn(),((t,n)=>e({shortcode:t,name:n})))}var Rn,qn={};c(qn,{useFetchImplementation:()=>Nn,validateGithub:()=>Mn});try{Rn=fetch}catch{}function Nn(t){Rn=t}async function Mn(t,e,n){try{return await(await Rn(`https://gist.github.com/${e}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch(t){return!1}}var $n={};c($n,{default:()=>Qn,v2:()=>Xn});var Dn=n(7218),Fn=n(8225),zn=n(3497),Vn=n(4330),Wn=n(9569),Kn=n(3061),Gn=n(8089),Zn=n(9187),Jn=new TextDecoder,Yn={minPlaintextSize:1,maxPlaintextSize:65535,utf8Encode:Gn.utf8ToBytes,utf8Decode:t=>Jn.decode(t),getConversationKey(t,e){const n=zn.secp256k1.getSharedSecret(t,"02"+e).subarray(1,33);return(0,Vn.extract)(Kn.sha256,n,"nip44-v2")},getMessageKeys(t,e){(0,Fn.ensureBytes)(t,32),(0,Fn.ensureBytes)(e,32);const n=(0,Vn.expand)(Kn.sha256,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}},calcPaddedLen(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)},writeU16BE(t){if(!Number.isSafeInteger(t)||t<Yn.minPlaintextSize||t>Yn.maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e},pad(t){const e=Yn.utf8Encode(t),n=e.length,r=Yn.writeU16BE(n),o=new Uint8Array(Yn.calcPaddedLen(n)-n);return(0,Gn.concatBytes)(r,e,o)},unpad(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<Yn.minPlaintextSize||e>Yn.maxPlaintextSize||n.length!==e||t.length!==2+Yn.calcPaddedLen(e))throw new Error("invalid padding");return Yn.utf8Decode(n)},hmacAad(t,e,n){if(32!==n.length)throw new Error("AAD associated data must be 32 bytes");const r=(0,Gn.concatBytes)(n,e);return(0,Wn.hmac)(Kn.sha256,t,r)},decodePayload(t){if("string"!=typeof t)throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if("#"===t[0])throw new Error("unknown encryption version");let n;try{n=Zn.base64.decode(t)}catch(t){throw new Error("invalid base64: "+t.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(2!==o)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}},Xn={utils:Yn,encrypt:function(t,e,n=(0,Gn.randomBytes)(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=Yn.getMessageKeys(e,n),s=Yn.pad(t),a=(0,Dn.chacha20)(r,o,s),c=Yn.hmacAad(i,a,n);return Zn.base64.encode((0,Gn.concatBytes)(new Uint8Array([2]),n,a,c))},decrypt:function(t,e){const{nonce:n,ciphertext:r,mac:o}=Yn.decodePayload(t),{chacha_key:i,chacha_nonce:s,hmac_key:a}=Yn.getMessageKeys(e,n),c=Yn.hmacAad(a,r,n);if(!(0,Fn.equalBytes)(c,o))throw new Error("invalid MAC");const u=(0,Dn.chacha20)(i,s,r);return Yn.unpad(u)}},Qn={v2:Xn},tr={};function er(t){const{pathname:e,searchParams:n}=new URL(t),r=e,o=n.get("relay"),i=n.get("secret");if(!r||!o||!i)throw new Error("invalid connection string");return{pubkey:r,relay:o,secret:i}}async function nr(t,e,n){const r={method:"pay_invoice",params:{invoice:n}},o=await Ke(e,t,JSON.stringify(r)),i={kind:kt,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]};return I(i,e)}c(tr,{makeNwcRequestEvent:()=>nr,parseConnectionString:()=>er});var rr={};c(rr,{getZapEndpoint:()=>ar,makeZapReceipt:()=>lr,makeZapRequest:()=>cr,useFetchImplementation:()=>sr,validateZapRequest:()=>ur});var or,ir=n(9187);try{or=fetch}catch{}function sr(t){or=t}async function ar(t){try{let e="",{lud06:n,lud16:r}=JSON.parse(t.content);if(n){let{words:t}=ir.bech32.decode(n,1e3),r=ir.bech32.fromWords(t);e=g.decode(r)}else{if(!r)return null;{let[t,n]=r.split("@");e=`https://${n}/.well-known/lnurlp/${t}`}}let o=await or(e),i=await o.json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch(t){}return null}function cr({profile:t,event:e,amount:n,relays:r,comment:o=""}){if(!n)throw new Error("amount not given");if(!t)throw new Error("profile not given");let i={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t],["amount",n.toString()],["relays",...r]]};return e&&i.tags.push(["e",e]),i}function ur(t){let e;try{e=JSON.parse(t)}catch(t){return"Invalid zap request JSON."}if(!p(e))return"Zap request is not a valid Nostr event.";if(!L(e))return"Invalid signature on zap request.";let n=e.tags.find((([t,e])=>"p"===t&&e));if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find((([t,e])=>"e"===t&&e));return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find((([t,e])=>"relays"===t&&e))?null:"Zap request doesn't have a 'relays' tag."}function lr({zapRequest:t,preimage:e,bolt11:n,paidAt:r}){let o=JSON.parse(t),i=o.tags.filter((([t])=>"e"===t||"p"===t||"a"===t)),s={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["P",o.pubkey],["bolt11",n],["description",t]]};return e&&s.tags.push(["preimage",e]),s}var fr={};c(fr,{getToken:()=>gr,hashPayload:()=>br,unpackEventFromToken:()=>wr,validateEvent:()=>vr,validateToken:()=>_r});var hr=n(8089),dr=n(3061),pr=n(9187),yr="Nostr ";function br(t){const e=(0,dr.sha256)(_.encode(JSON.stringify(t)));return(0,hr.bytesToHex)(e)}async function gr(t,e,n,r=!1,o){const i={kind:Lt,tags:[["u",t],["method",e]],created_at:Math.round((new Date).getTime()/1e3),content:""};o&&i.tags.push(["payload",(0,hr.bytesToHex)((0,dr.sha256)(_.encode(JSON.stringify(o))))]);const s=await n(i);return(r?yr:"")+pr.base64.encode(_.encode(JSON.stringify(s)))}async function _r(t,e,n){const r=await wr(t).catch((t=>{throw t}));return await vr(r,e,n).catch((t=>{throw t}))}async function wr(t){if(!t)throw new Error("Missing token");t=t.replace(yr,"");const e=g.decode(pr.base64.decode(t));if(!e||0===e.length||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}async function vr(t,e,n,r){if(!t)throw new Error("Invalid nostr event");if(!L(t))throw new Error("Invalid nostr event, signature invalid");if(t.kind!==Lt)throw new Error("Invalid nostr event, kind invalid");if(!t.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-t.created_at>60)throw new Error("Invalid nostr event, expired");const o=t.tags.find((t=>"u"===t[0]));if(1!==o?.length&&o?.[1]!==e)throw new Error("Invalid nostr event, url tag invalid");const i=t.tags.find((t=>"method"===t[0]));if(1!==i?.length&&i?.[1].toLowerCase()!==n.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");if(Boolean(r)&&Object.keys(r).length>0){const e=t.tags.find((t=>"payload"===t[0])),n=(0,hr.bytesToHex)((0,dr.sha256)(_.encode(JSON.stringify(r))));if(e?.[1]!==n)throw new Error("Invalid payload tag hash, does not match request body hash")}return!0}},9794:t=>{"use strict";t.exports={version:"1.0.34"}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n(8519)})();